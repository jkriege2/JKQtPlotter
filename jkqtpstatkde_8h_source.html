<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JKQTPlotter: jkqtpstatkde.h Source File</title>
<meta name="description" content="an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies">
<meta name="keywords" lang="en-us" content="C++, C++11, Qt, Qt5, Qt6, Plotting, Plot, Chart, Graph, Qt, Widget, C++, Library, Visualization, charting library, plotting library, scientific visualization, data visualization, statistics, statistical methods, statistics library, LaTeX parser, LaTeX renderer, Qt widget, Qt5 widget, Qt6 widget, Qt charts, Qt plots, barchart, violinplot, boxplot, JKQtPlotter, JKQTMathText, JKQTFastPlotter">
<meta name="author" content="$author">
<meta name="copyright" content="(c) 2008-2022 by $author">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="jkqtplotter_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_doxygen.png"/></td>
  <td id="projectalign">
   <div id="projectname">JKQTPlotter<span id="projectnumber">&#160;trunk/v5.0.0</span>
   </div>
   <div id="projectbrief">an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<div id="main-nav">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- main-nav -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('jkqtpstatkde_8h_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">jkqtpstatkde.h</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">    Copyright (c) 2008-2024 Jan W. Krieger (&lt;jan@jkrieger.de&gt;)</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"></span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">    last modification: $LastChangedDate$  (revision $Rev$)</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"></span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">    This software is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">    it under the terms of the GNU Lesser General Public License (LGPL) as published by</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">    the Free Software Foundation, either version 2.1 of the License, or</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">    (at your option) any later version.</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"></span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">    This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">    GNU Lesser General Public License (LGPL) for more details.</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"></span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">    You should have received a copy of the GNU Lesser General Public License (LGPL)</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">*/</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#ifndef JKQTPSTATKDE_H_INCLUDED</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#define JKQTPSTATKDE_H_INCLUDED</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;ostream&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;jkqtmath/jkqtmath_imexport.h&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;jkqtmath/jkqtplinalgtools.h&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;jkqtmath/jkqtparraytools.h&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;jkqtcommon/jkqtpdebuggingtools.h&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;jkqtmath/jkqtpstatbasics.h&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment"></span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment">/*! \brief a 1D Gaussian kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="comment"></span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="comment">    \f[ k(t):=\frac{1}{\sqrt{2\pi}}\exp \left(-\frac{1}{2}t^2\right) \f]</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00052" data-start="{" data-end="}">
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">   52</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    <span class="keywordflow">return</span> exp(-0.5*t*t)/<a class="code hl_define" href="group__jkqtptools__math__basic.html#ga4d3c8d42b6da8741d2fc400d93f8129b">JKQTPSTATISTICS_SQRT_2PI</a>;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>}<span class="comment"></span></div>
</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="comment">/*! \brief a 1D Cauchy kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment"></span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="comment">    \f[ k(t):=\frac{1}{\pi(1+t^2)} \f]</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00060" data-start="{" data-end="}">
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gace17a03ec91b13f75dc324d3271b5966">   60</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gace17a03ec91b13f75dc324d3271b5966">jkqtpstatKernel1DCauchy</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="keywordflow">return</span> 1.0/(<a class="code hl_define" href="group__jkqtptools__math__basic.html#gae96ac530dff57dae111b641b0c7f4eb4">JKQTPSTATISTICS_PI</a>*(1.0+t*t));</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>}</div>
</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="comment"></span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">/*! \brief a 1D Picard kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment"></span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment">    \f[ k(t):=\frac{1}{2}\exp(-|t|) \f]</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00069" data-start="{" data-end="}">
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gaee8824008ed849cbb0c723966bfd2feb">   69</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gaee8824008ed849cbb0c723966bfd2feb">jkqtpstatKernel1DPicard</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keywordflow">return</span> exp(-0.5*fabs(t))/2.0;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>}<span class="comment"></span></div>
</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="comment">/*! \brief a 1D Epanechnikov kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment"></span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment">    \f[ k(t) :=\begin{cases}\frac{3}{4} ( 1- t^2 ),  &amp; \text{if }t\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00077" data-start="{" data-end="}">
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacf48fe6890853c4592841ae85962d8ed">   77</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacf48fe6890853c4592841ae85962d8ed">jkqtpstatKernel1DEpanechnikov</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    <span class="keywordflow">return</span> (fabs(t)&lt;1.0)?(0.75*(1.0-t*t)):0.0;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>}<span class="comment"></span></div>
</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="comment">/*! \brief a 1D uniform kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="comment"></span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="comment">    \f[ k(t) :=\begin{cases}0.5,  &amp; \text{if }t\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00085" data-start="{" data-end="}">
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga15b11fe1d910aae2516eb2ee291e337d">   85</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga15b11fe1d910aae2516eb2ee291e337d">jkqtpstatKernel1DUniform</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keywordflow">return</span> (fabs(t)&lt;=1.0)?0.5:0.0;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>}<span class="comment"></span></div>
</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="comment">/*! \brief a 1D Epanechnikov kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="comment"></span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="comment">    \f[ k(t) :=\begin{cases}1-|t|,  &amp; \text{if }t\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00093" data-start="{" data-end="}">
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gae1dfc12ace64c004d81f857ac889216d">   93</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gae1dfc12ace64c004d81f857ac889216d">jkqtpstatKernel1DTriangle</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <span class="keywordflow">return</span> (fabs(t)&lt;=1.0)?(1.0-fabs(t)):0.0;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>}</div>
</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="comment"></span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="comment">/*! \brief a 1D quartic kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="comment"></span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="comment">    \f[ k(t) :=\begin{cases}\frac{15}{16}(1-t^2)^2,  &amp; \text{if }t\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00102" data-start="{" data-end="}">
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga4b0be7c33c1924e20133c9cc991b92d4">  102</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga4b0be7c33c1924e20133c9cc991b92d4">jkqtpstatKernel1DQuartic</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="keywordflow">return</span> (fabs(t)&lt;=1.0)?(15.0/16.0*<a class="code hl_function" href="group__jkqtptools__math__basic.html#gacb0b84ffd616c54365266f907cedf400">jkqtp_sqr</a>(1.0-t*t)):0.0;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>}<span class="comment"></span></div>
</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="comment">/*! \brief a 1D triweight kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="comment"></span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="comment">    \f[ k(t) :=\begin{cases}\frac{35}{32}(1-t^2)^3,  &amp; \text{if }t\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00110" data-start="{" data-end="}">
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacd7acec82b29460d5c42b0f37d375399">  110</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacd7acec82b29460d5c42b0f37d375399">jkqtpstatKernel1DTriweight</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <span class="keywordflow">return</span> (fabs(t)&lt;1.0)?(35.0/32.0*<a class="code hl_function" href="group__jkqtptools__math__basic.html#gacbbf91f431ae7c1a9a01ac1a4881491d">jkqtp_cube</a>(1.0-t*t)):0.0;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>}</div>
</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span><span class="comment"></span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="comment">/*! \brief a 1D tricube kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="comment"></span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="comment">    \f[ k(t) :=\begin{cases}\frac{70}{81}(1-|t|^3)^3,  &amp; \text{if }t\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00119" data-start="{" data-end="}">
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga814d88ca8155d903a6e667554d8ffc8e">  119</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga814d88ca8155d903a6e667554d8ffc8e">jkqtpstatKernel1DTricube</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="keywordflow">return</span> (fabs(t)&lt;1.0)?(70.0/81.0*<a class="code hl_function" href="group__jkqtptools__math__basic.html#gacbbf91f431ae7c1a9a01ac1a4881491d">jkqtp_cube</a>(1.0-<a class="code hl_function" href="group__jkqtptools__math__basic.html#gacbbf91f431ae7c1a9a01ac1a4881491d">jkqtp_cube</a>(fabs(t)))):0.0;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>}<span class="comment"></span></div>
</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="comment">/*! \brief a 1D cosine kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde_kernels</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="comment"></span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="comment">    \f[ k(t) :=\begin{cases}\frac{\pi}{4}\cos\left(\frac{\pi}{2}t\right),  &amp; \text{if }t\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00127" data-start="{" data-end="}">
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga389ecf091eea9940375ed53b2db611b0">  127</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga389ecf091eea9940375ed53b2db611b0">jkqtpstatKernel1DCosine</a>(<span class="keywordtype">double</span> t) {</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keywordflow">return</span> (fabs(t)&lt;1.0)?(<a class="code hl_define" href="group__jkqtptools__math__basic.html#gae96ac530dff57dae111b641b0c7f4eb4">JKQTPSTATISTICS_PI</a>/4.0*cos(t*<a class="code hl_define" href="group__jkqtptools__math__basic.html#gae96ac530dff57dae111b641b0c7f4eb4">JKQTPSTATISTICS_PI</a>/2.0)):0.0;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>}</div>
</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span><span class="comment"></span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span><span class="comment">/*! \brief a 2D Gaussian kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span><span class="comment">    \ingroup jkqtptools_math_statistics_2dkde_kernels</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="comment"></span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="comment">    \f[ k(t_x, t_y):=\frac{1}{2\pi}\exp \left(-\frac{t_x^2+t_y^2}{2}\right) \f]</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00148" data-start="{" data-end="}">
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">  148</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">jkqtpstatKernel2DGaussian</a>(<span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty)</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>{</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="keywordflow">return</span> exp(-0.5*(tx*tx+ty*ty))/(2.0*<a class="code hl_define" href="group__jkqtptools__math__basic.html#gae96ac530dff57dae111b641b0c7f4eb4">JKQTPSTATISTICS_PI</a>);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>}</div>
</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment"></span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="comment">/*! \brief a 2D Uniform kernel function, e.g. for Kernel Density Estimation</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="comment">    \ingroup jkqtptools_math_statistics_2dkde_kernels</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="comment"></span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="comment">    \f[ k(t_x, t_y):=\begin{cases}\frac{1}{4},  &amp; \text{if }t_x,t_y\in [-1;1]\\0, &amp; \text{else}\end{cases} \f]</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00158" data-start="{" data-end="}">
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__2dkde__kernels.html#ga90e986c268fabfddc394b61adecc6ea2">  158</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#ga90e986c268fabfddc394b61adecc6ea2">jkqtpstatKernel2DUniform</a>(<span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="keywordflow">return</span> (fabs(tx)&lt;1.0 &amp;&amp; fabs(ty)&lt;=1.0)?0.25:0.0;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>}</div>
</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="comment"></span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span><span class="comment">/*! \brief estimates a bandwidth for a Kernel Density Estimator (KDE) of the given data \a first ... \a last</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span><span class="comment"></span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span><span class="comment">    evaluates \f[ h = \left(\frac{4\hat{\sigma}^5}{3n}\right)^{\frac{1}{5}} \approx 1.06 \hat{\sigma} n^{-1/5} \f]</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="comment"></span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span><span class="comment">    \tparam InputIt standard iterator type of \a first and \a last.</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span><span class="comment">    \param first iterator pointing to the first item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span><span class="comment">    \param last iterator pointing behind the last item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="comment">    \return the estimated bandwidth</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span><span class="comment"></span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="comment">*/</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputIt&gt;</div>
<div class="foldopen" id="foldopen00192" data-start="{" data-end="}">
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">  192</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a>(InputIt first, InputIt last) {</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="keywordtype">size_t</span> N=0;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> sigma=<a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga0cbd4d4f762fe7c05fa143e643988c21">jkqtpstatStdDev</a>(first, last, <span class="keyword">nullptr</span>, &amp;N);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keywordflow">return</span> 1.06*sigma/pow(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(N), 1.0/5.0);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>}</div>
</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="comment"></span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="comment">/*! \brief evaluates the Kernel Density Estimator (KDE) at a given position</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span><span class="comment"></span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span><span class="comment">    evaluates \f[ \tilde{f}(t):=\frac{1}{N\cdot\text{bandwidth}}\cdot\sum\limits_{i=0}^{N-1}K\left(\frac{t-x_i}{\text{bandwidth}}\right) \f]</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span><span class="comment"></span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span><span class="comment">    \tparam InputIt standard iterator type of \a first and \a last.</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span><span class="comment">    \param t where to evaluate the kernel sum</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span><span class="comment">    \param first iterator pointing to the first item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="comment">    \param last iterator pointing behind the last item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel1DGaussian() )</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span><span class="comment">    \param bandwidth bandwidth used for the KDE</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span><span class="comment"></span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span><span class="comment">*/</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputIt&gt;</div>
<div class="foldopen" id="foldopen00215" data-start="{" data-end="}">
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">  215</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a>(<span class="keywordtype">double</span> t, InputIt first, InputIt last, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;&amp; kernel, <span class="keywordtype">double</span> bandwidth) {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <span class="keywordtype">double</span> res=0;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="keywordtype">size_t</span> cnt=0;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it=first; it!=last; ++it)  {</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> v=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a>(*it);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a>(v)) {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vx=(t-v)/bandwidth;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            res+=kernel(vx);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            cnt++;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keywordflow">if</span> (cnt==0) <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="keywordflow">return</span> res/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(cnt)/bandwidth;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>}</div>
</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span><span class="comment"></span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span><span class="comment">/*! \brief calculate an autoranged 1-dimensional Kernel Density Estimation (KDE) from the given data range \a first ... \a last, bins defined by their number</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span><span class="comment"></span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="comment">    \tparam InputIt standard iterator type of \a first and \a last.</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span><span class="comment">    \tparam OutputIt standard output iterator type used for the outliers output \a KDEXOut and \a KDEYOut, use e.g. std::back_inserter</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span><span class="comment">    \param first iterator pointing to the first item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span><span class="comment">    \param last iterator pointing behind the last item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel1DGaussian() )</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="comment">    \param bandwidth bandwidth used for the KDE</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="comment">    \param[out] KDEXOut output iterator that receives x-positions of the KDE bins. Location of this value inside the bin range is defined by \a binXMode</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="comment">    \param[out] KDEYOut output iterator that receives counts/frequencies of the KDE bins</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="comment">    \param Nout number datapoints in the output KDE</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="comment">    \param cummulative if \c true, a cummulative KDE is calculated</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="comment"></span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="comment">    This function performs &lt;a href=&quot;https://en.wikipedia.org/wiki/Kernel_density_estimation&quot;&gt;Kernel Density Estimation&lt;/a&gt; for a given data array.</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="comment">    Then the resulting density is evaluated on a regular grid spanning [min(X)...max(X)] with bins datapoints in between.</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="comment"></span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="comment">    \warning this functions is getting very slow for large dataset, as for each point in the resulting histogram N kernel functions have to be evaluated.</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="comment"></span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="comment">    \see https://en.wikipedia.org/wiki/Kernel_density_estimation, \ref JKQTPlotterBasicJKQTPDatastoreStatistics</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="comment">*/</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputIt, <span class="keyword">class</span> OutputIt&gt;</div>
<div class="foldopen" id="foldopen00255" data-start="{" data-end="}">
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde.html#ga2a72307b6aa56efce8d8b2baffeb9270">  255</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#ga2a72307b6aa56efce8d8b2baffeb9270">jkqtpstatKDE1DAutoranged</a>(InputIt first, InputIt last, OutputIt KDEXOut, OutputIt KDEYOut, <span class="keywordtype">int</span> Nout=100, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;&amp; kernel=std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;(&amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a>), <span class="keywordtype">double</span> bandwidth=1.0, <span class="keywordtype">bool</span> cummulative=<span class="keyword">false</span>) {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="keywordtype">double</span> minV=0, maxV=0;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="keywordtype">size_t</span> N=0;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax&lt;InputIt&gt;</a>(first, last, minV, maxV, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, &amp;N);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    std::vector&lt;double&gt; histX;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    std::vector&lt;double&gt; histY;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> range=maxV-minV;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> binw=range/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(Nout);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <span class="comment">// calculate the KDE</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> xi=minV; xi&lt;=maxV; xi+=binw)  {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        histX.push_back(xi);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        histY.push_back(<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a>(xi, first, last, kernel, bandwidth));</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    }</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="keywordflow">if</span> (histX.size()&gt;0 &amp;&amp; histX[histX.size()-1]&lt;maxV) {</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>        histX.push_back(maxV);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        histY.push_back(<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a>(maxV, first, last, kernel, bandwidth));</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    }</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="comment">// output the KDE</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="keywordtype">double</span> h=0;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;histX.size(); i++) {</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        *KDEXOut=histX[i];</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        <span class="keywordflow">if</span> (cummulative) h+=histY[i];</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <span class="keywordflow">else</span> h=histY[i];</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        *KDEYOut=h;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        ++KDEXOut;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        ++KDEYOut;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>}</div>
</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment"></span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment">/*! \brief calculate an autoranged 1-dimensional Kernel Density Estimation (KDE) from the given data range \a first ... \a last, bins defined by their number</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment"></span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="comment">    \tparam InputIt standard iterator type of \a first and \a last.</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span><span class="comment">    \tparam OutputIt standard output iterator type used for the outliers output \a KDEXOut and \a KDEYOut, use e.g. std::back_inserter</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="comment">    \param first iterator pointing to the first item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span><span class="comment">    \param last iterator pointing behind the last item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel1DGaussian() )</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">    \param bandwidth bandwidth used for the KDE</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="comment">    \param[out] KDEXOut output iterator that receives x-positions of the KDE bins. Location of this value inside the bin range is defined by \a binXMode</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span><span class="comment">    \param[out] KDEYOut output iterator that receives counts/frequencies of the KDE bins</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span><span class="comment">    \param binWidth width of the bins</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="comment">    \param cummulative if \c true, a cummulative KDE is calculated</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span><span class="comment"></span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span><span class="comment">    This function performs &lt;a href=&quot;https://en.wikipedia.org/wiki/Kernel_density_estimation&quot;&gt;Kernel Density Estimation&lt;/a&gt; for a given data array.</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span><span class="comment">    Then the resulting density is evaluated on a regular grid spanning [min(X)...max(X)] with bins datapoints in between.</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span><span class="comment"></span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span><span class="comment">    \warning this functions is getting very slow for large dataset, as for each point in the resulting histogram N kernel functions have to be evaluated.</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span><span class="comment"></span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="comment">    \see https://en.wikipedia.org/wiki/Kernel_density_estimation, \ref JKQTPlotterBasicJKQTPDatastoreStatistics</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span><span class="comment">*/</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputIt, <span class="keyword">class</span> OutputIt&gt;</div>
<div class="foldopen" id="foldopen00313" data-start="{" data-end="}">
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde.html#gad8e716d280791f5e1b8c7eefdfd8f7aa">  313</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#ga2a72307b6aa56efce8d8b2baffeb9270">jkqtpstatKDE1DAutoranged</a>(InputIt first, InputIt last, OutputIt KDEXOut, OutputIt KDEYOut, <span class="keywordtype">double</span> binWidth, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;&amp; kernel=std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;(&amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a>), <span class="keywordtype">double</span> bandwidth=1.0, <span class="keywordtype">bool</span> cummulative=<span class="keyword">false</span>) {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <span class="keywordtype">double</span> minV=0, maxV=0;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <span class="keywordtype">size_t</span> N=0;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    <a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax&lt;InputIt&gt;</a>(first, last, minV, maxV, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, &amp;N);</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    std::vector&lt;double&gt; histX;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    std::vector&lt;double&gt; histY;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> binw=binWidth;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    <span class="comment">// calculate the KDE</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> xi=minV; xi&lt;=maxV; xi+=binw)  {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        histX.push_back(xi);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>        histY.push_back(<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a>(xi, first, last, kernel, bandwidth));</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="keywordflow">if</span> (histX.size()&gt;0 &amp;&amp; histX[histX.size()-1]&lt;maxV) {</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        histX.push_back(maxV);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        histY.push_back(<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a>(maxV, first, last, kernel, bandwidth));</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    }</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="comment">// output the KDE</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="keywordtype">double</span> h=0;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;histX.size(); i++) {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        *KDEXOut=histX[i];</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        <span class="keywordflow">if</span> (cummulative) h+=histY[i];</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="keywordflow">else</span> h=histY[i];</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        *KDEYOut=h;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        ++KDEXOut;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        ++KDEYOut;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    }</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>}</div>
</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment"></span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment">/*! \brief calculate an autoranged 1-dimensional Kernel Density Estimation (KDE) from the given data range \a first ... \a last, bins defined the range \a binsFirst ... \a binsLast</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment"></span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment">    \tparam InputIt standard iterator type of \a first and \a last.</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="comment">    \tparam BinsInputIt standard iterator type of \a binsFirst and \a binsLast.</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="comment">    \tparam OutputIt standard output iterator type used for the outliers output \a KDEXOut and \a KDEYOut, use e.g. std::back_inserter</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="comment">    \param first iterator pointing to the first item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="comment">    \param last iterator pointing behind the last item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="comment">    \param binsFirst iterator pointing to the first item in the set of KDE bins</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span><span class="comment">    \param binsLast iterator pointing behind the last item in the set of KDE bins</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="comment">    \param[out] KDEXOut output iterator that receives x-positions of the KDE bins. Location of this value inside the bin range is defined by \a binXMode</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="comment">    \param[out] KDEYOut output iterator that receives counts/frequencies of the KDE bins</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel1DGaussian() )</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="comment">    \param bandwidth bandwidth used for the KDE</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="comment">    \param cummulative if \c true, a cummulative KDE is calculated</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment"></span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="comment">    \see https://en.wikipedia.org/wiki/Kernel_density_estimation, \ref JKQTPlotterBasicJKQTPDatastoreStatistics</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment">*/</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputIt, <span class="keyword">class</span> BinsInputIt, <span class="keyword">class</span> OutputIt&gt;</div>
<div class="foldopen" id="foldopen00368" data-start="{" data-end="}">
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde.html#gaea1ca0066c61947e8a8a7d8deaa36d3e">  368</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaea1ca0066c61947e8a8a7d8deaa36d3e">jkqtpstatKDE1D</a>(InputIt first, InputIt last, BinsInputIt binsFirst, BinsInputIt binsLast, OutputIt KDEXOut, OutputIt KDEYOut, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;&amp; kernel=std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;(&amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a>), <span class="keywordtype">double</span> bandwidth=1.0, <span class="keywordtype">bool</span> cummulative=<span class="keyword">false</span>) {</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <span class="keywordtype">double</span> minV=0, maxV=0;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="keywordtype">size_t</span> N=0;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax&lt;InputIt&gt;</a>(first, last, minV, maxV, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, &amp;N);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    std::vector&lt;double&gt; histX;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    std::vector&lt;double&gt; histY;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="comment">// initialize the KDE</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it=binsFirst; it!=binsLast; ++it)  {</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        histX.push_back(<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a>(*it));</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    }</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    std::sort(histX.begin(), histX.end());</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span> </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="comment">// calculate the KDE</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it=histX.begin(); it!=histX.end(); ++it) {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        histY.push_back(<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a>(*it, first, last, kernel, bandwidth));</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <span class="comment">// output the KDE</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <span class="keywordtype">double</span> h=0;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;histX.size(); i++) {</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        *KDEXOut=histX[i];</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        <span class="keywordflow">if</span> (cummulative) h+=histY[i];</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        <span class="keywordflow">else</span> h=histY[i];</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        *KDEYOut=h;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>        ++KDEXOut;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        ++KDEYOut;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    }</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>}</div>
</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="comment"></span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span><span class="comment">/*! \brief calculate an autoranged 1-dimensional Kernel Density Estimation (KDE) from the given data range \a first ... \a last, evaluation positions are given by the range \a binXLeft ... \a binXRight (in steps of \a binxDelta )</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span><span class="comment">    \ingroup jkqtptools_math_statistics_1dkde</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span><span class="comment"></span> </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span><span class="comment">    \tparam InputIt standard iterator type of \a first and \a last.</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span><span class="comment">    \tparam OutputIt standard output iterator type used for the outliers output \a KDEXOut and \a KDEYOut, use e.g. std::back_inserter</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span><span class="comment">    \param first iterator pointing to the first item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span><span class="comment">    \param last iterator pointing behind the last item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span><span class="comment">    \param binXLeft first x-position, where to evaluate the KDE</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span><span class="comment">    \param binXDelta distance between two x-positions at which the KDE is evaluated</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span><span class="comment">    \param binXRight last x-position, where to evaluate the KDE</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span><span class="comment">    \param[out] KDEXOut output iterator that receives x-positions of the KDE bins. Location of this value inside the bin range is defined by \a binXMode</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span><span class="comment">    \param[out] KDEYOut output iterator that receives counts/frequencies of the KDE bins</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel1DGaussian() )</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span><span class="comment">    \param bandwidth bandwidth used for the KDE</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span><span class="comment">    \param cummulative if \c true, a cummulative KDE is calculated</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span><span class="comment"></span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span><span class="comment">    \see https://en.wikipedia.org/wiki/Kernel_density_estimation, \ref JKQTPlotterBasicJKQTPDatastoreStatistics</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span><span class="comment">*/</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputIt, <span class="keyword">class</span> OutputIt&gt;</div>
<div class="foldopen" id="foldopen00424" data-start="{" data-end="}">
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__1dkde.html#ga82147ac3e334f92317c72fe350051358">  424</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaea1ca0066c61947e8a8a7d8deaa36d3e">jkqtpstatKDE1D</a>(InputIt first, InputIt last, <span class="keywordtype">double</span> binXLeft, <span class="keywordtype">double</span> binXDelta, <span class="keywordtype">double</span> binXRight, OutputIt KDEXOut, OutputIt KDEYOut, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;&amp; kernel=std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>)&gt;(&amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a>), <span class="keywordtype">double</span> bandwidth=1.0, <span class="keywordtype">bool</span> cummulative=<span class="keyword">false</span>) {</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <span class="keywordtype">double</span> minV=0, maxV=0;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <span class="keywordtype">size_t</span> N=0;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax&lt;InputIt&gt;</a>(first, last, minV, maxV, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, &amp;N);</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    std::vector&lt;double&gt; histX;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    std::vector&lt;double&gt; histY;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <span class="comment">// calculate the KDE</span></div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> x=binXLeft; x&lt;=binXRight; x+=binXDelta)  {</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        histX.push_back(x);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        histY.push_back(<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a>(x, first, last, kernel, bandwidth));</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="comment">// output the KDE</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordtype">double</span> h=0;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;histX.size(); i++) {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>        *KDEXOut=histX[i];</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <span class="keywordflow">if</span> (cummulative) h+=histY[i];</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        <span class="keywordflow">else</span> h=histY[i];</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        *KDEYOut=h;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>        ++KDEXOut;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>        ++KDEYOut;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    }</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>}</div>
</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span><span class="comment"></span> </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span><span class="comment">/*! \brief evaluates the Kernel Density Estimator (KDE) at a given position</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="comment">    \ingroup jkqtptools_math_statistics_2dkde</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="comment"></span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="comment">    evaluates \f[ \tilde{f}(x,y):=\frac{1}{N\cdot\sqrt{\text{bandwidthx}}\cdot\sqrt{\text{bandwidthy}}}\cdot\sum\limits_{i=0}^{N-1}K\left(\frac{x-x_i}{\text{bandwidthx}},\frac{y-y_i}{\text{bandwidthy}}\right) \f]</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span><span class="comment"></span> </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span><span class="comment">    \tparam InputItX standard iterator type of \a firstX and \a lastX.</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span><span class="comment">    \tparam InputItY standard iterator type of \a firstY and \a lastY.</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><span class="comment">    \param x where to evaluate the kernel sum, x-coordinate</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span><span class="comment">    \param y where to evaluate the kernel sum, y-coordinate</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span><span class="comment">    \param firstX iterator pointing to the first x-position item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span><span class="comment">    \param lastX iterator pointing behind the last x-position item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span><span class="comment">    \param firstY iterator pointing to the first y-position item in the dataset to use \f$ Y_1 \f$</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span><span class="comment">    \param lastY iterator pointing behind the last y-position item in the dataset to use \f$ Y_N \f$</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel1DGaussian() )</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span><span class="comment">    \param bandwidthX x-bandwidth used for the KDE</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span><span class="comment">    \param bandwidthY y-bandwidth used for the KDE</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span><span class="comment"></span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span><span class="comment">*/</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputItX, <span class="keyword">class</span> InputItY&gt;</div>
<div class="foldopen" id="foldopen00480" data-start="{" data-end="}">
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__2dkde.html#ga5a942e00c033a0125cbd6991be062e08">  480</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#ga5a942e00c033a0125cbd6991be062e08">jkqtpstatEvaluateKernelSum2D</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>,<span class="keywordtype">double</span>)&gt;&amp; kernel, <span class="keywordtype">double</span> bandwidthX, <span class="keywordtype">double</span> bandwidthY) {</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    <span class="keywordtype">double</span> res=0;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <span class="keywordtype">size_t</span> cnt=0;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <span class="keyword">auto</span> itX=firstX;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <span class="keyword">auto</span> itY=firstY;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="keywordflow">for</span> (; (itX!=lastX)&amp;&amp;(itY!=lastY); ++itX, ++itY)  {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> vx=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a>(*itX);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> vy=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a>(*itY);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a>(vx) &amp;&amp; <a class="code hl_function" href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a>(vy)) {</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vvx=(x-vx)/bandwidthX;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vvy=(y-vy)/bandwidthY;</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>            res+=kernel(vvx,vvy);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            cnt++;</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        }</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="keywordflow">if</span> (cnt==0) <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    <span class="keywordflow">return</span> res/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(cnt)/sqrt(bandwidthX*bandwidthY);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>}</div>
</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span><span class="comment"></span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="comment">/*! \brief stores a part-result of the Kernel Density Estimator (KDE) at a given position</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span><span class="comment">    \ingroup jkqtptools_math_statistics_2dkde</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="comment">    \internal</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment"></span> </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="comment">    Iterates over all datapoints in firstX..lastX and firstY..lastY, for each one determines whether the floating-point values are valid</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="comment">    and the calls fStore, which is a functor that is supposed to iterate over the KDE 2D array and over calls sum up the KDE.</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="comment"></span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span><span class="comment">    This is internally used by jkqtpstatKDE2D(). The construction is not as straight-forward, as iterating over all positions in the 2D-KJDE</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span><span class="comment">    and the calling jkqtpstatEvaluateKernelSum2D(), bt by reordering the loops it is significatyl faster (~20%)</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span><span class="comment"></span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span><span class="comment">    \tparam InputItX standard iterator type of \a firstX and \a lastX.</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span><span class="comment">    \tparam InputItY standard iterator type of \a firstY and \a lastY.</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span><span class="comment">    \tparam FF functor</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span><span class="comment">    \param x where to evaluate the kernel sum, x-coordinate</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span><span class="comment">    \param y where to evaluate the kernel sum, y-coordinate</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span><span class="comment">    \param firstX iterator pointing to the first x-position item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span><span class="comment">    \param lastX iterator pointing behind the last x-position item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span><span class="comment">    \param firstY iterator pointing to the first y-position item in the dataset to use \f$ Y_1 \f$</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span><span class="comment">    \param lastY iterator pointing behind the last y-position item in the dataset to use \f$ Y_N \f$</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel1DGaussian() )</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="comment">    \param bandwidthX x-bandwidth used for the KDE</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span><span class="comment">    \param bandwidthY y-bandwidth used for the KDE</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span><span class="comment"></span> </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span><span class="comment">*/</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputItX, <span class="keyword">class</span> InputItY, <span class="keyword">class</span> FF&gt;</div>
<div class="foldopen" id="foldopen00526" data-start="{" data-end="}">
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__2dkde.html#ga6180cc1b0cb92cbe75e2594b657cff24">  526</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#ga6180cc1b0cb92cbe75e2594b657cff24">jkqtpstatStoreKernelSum2D</a>(FF&amp;&amp; fStore, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>,<span class="keywordtype">double</span>)&gt;&amp; kernel, <span class="keywordtype">double</span> bandwidthX, <span class="keywordtype">double</span> bandwidthY) {</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    <span class="keyword">auto</span> itX=firstX;</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    <span class="keyword">auto</span> itY=firstY;</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    <span class="keywordtype">int</span> cnt=0;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    <span class="keywordflow">for</span> (; (itX!=lastX)&amp;&amp;(itY!=lastY); ++itX, ++itY)  {</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> vx=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a>(*itX);</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> vy=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a>(*itY);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a>(vx) &amp;&amp; <a class="code hl_function" href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a>(vy)) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>            fStore(vx,vy, kernel,bandwidthX, bandwidthY);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            cnt++;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>        }</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    <span class="keywordflow">return</span> cnt;</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>}</div>
</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span><span class="comment"></span> </div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span><span class="comment">/*! \brief calculate an autoranged 2-dimensional Kernel Density Estimation (KDE) from the given data range \a firstX / \a firstY ... \a lastY / \a lastY</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span><span class="comment">    \ingroup jkqtptools_math_statistics_2dkde</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span><span class="comment"></span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span><span class="comment">    \tparam InputItX standard iterator type of \a firstX and \a lastX.</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span><span class="comment">    \tparam InputItY standard iterator type of \a firstY and \a lastY.</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span><span class="comment">    \tparam OutputIt standard output iterator type used for the outliers output \a histogramXOut and \a histogramYOut, use e.g. std::back_inserter</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span><span class="comment">    \param firstX iterator pointing to the first x-position item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span><span class="comment">    \param lastX iterator pointing behind the last x-position item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span><span class="comment">    \param firstY iterator pointing to the first y-position item in the dataset to use \f$ Y_1 \f$</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span><span class="comment">    \param lastY iterator pointing behind the last y-position item in the dataset to use \f$ Y_N \f$</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span><span class="comment">    \param[out] histogramImgOut output iterator that receives counts of the histogram bins in row-major ordering</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span><span class="comment">    \param xmin position of the first histogram bin in x-direction</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span><span class="comment">    \param xmax position of the last histogram bin in x-direction</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span><span class="comment">    \param ymin position of the first histogram bin in y-direction</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span><span class="comment">    \param ymax position of the last histogram bin in y-direction</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span><span class="comment">    \param xbins number of bins in x-direction (i.e. width of the output histogram \a histogramImgOut )</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span><span class="comment">    \param ybins number of bins in y-direction (i.e. height of the output histogram \a histogramImgOut )</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span><span class="comment">    \param kernel the kernel function to use (e.g. jkqtpstatKernel2DGaussian() )</span></div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span><span class="comment">    \param bandwidthX x-bandwidth used for the KDE</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span><span class="comment">    \param bandwidthY y-bandwidth used for the KDE</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="comment"></span> </div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span><span class="comment">    \see https://en.wikipedia.org/wiki/Multivariate_kernel_density_estimation, \ref JKQTPlotterBasicJKQTPDatastoreStatistics</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span><span class="comment">*/</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputItX, <span class="keyword">class</span> InputItY, <span class="keyword">class</span> OutputIt&gt;</div>
<div class="foldopen" id="foldopen00566" data-start="{" data-end="}">
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d">  566</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d">jkqtpstatKDE2D</a>(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, OutputIt histogramImgOut, <span class="keywordtype">double</span> xmin, <span class="keywordtype">double</span> xmax, <span class="keywordtype">double</span> ymin, <span class="keywordtype">double</span> ymax, <span class="keywordtype">size_t</span> xbins, <span class="keywordtype">size_t</span> ybins, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>,<span class="keywordtype">double</span>)&gt;&amp; kernel=std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>,<span class="keywordtype">double</span>)&gt;(&amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">jkqtpstatKernel2DGaussian</a>), <span class="keywordtype">double</span> bandwidthX=1.0, <span class="keywordtype">double</span> bandwidthY=1.0) {</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> binwx=fabs(xmax-xmin)/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(xbins);</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> binwy=fabs(ymax-ymin)/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(ybins);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    {</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        <span class="keyword">auto</span> itOut=histogramImgOut;</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> by=0; by&lt;ybins; by++) {</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> bx=0; bx&lt;xbins; bx++) {</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>                *itOut=0;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>                ++itOut;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>            }</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        }</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    }</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cnt=<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#ga6180cc1b0cb92cbe75e2594b657cff24">jkqtpstatStoreKernelSum2D</a>([&amp;](<span class="keywordtype">double</span> vx, <span class="keywordtype">double</span> vy, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">double</span>(<span class="keywordtype">double</span>,<span class="keywordtype">double</span>)&gt;&amp; kernel, <span class="keywordtype">double</span> bandwidthX, <span class="keywordtype">double</span> bandwidthY){</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="keywordtype">double</span> y=ymin;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        <span class="keyword">auto</span> itOut=histogramImgOut;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> by=0; by&lt;ybins; by++) {</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>            <span class="keywordtype">double</span> x=xmin;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> bx=0; bx&lt;xbins; bx++) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> vvx=(x-vx)/bandwidthX;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> vvy=(y-vy)/bandwidthY;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>                *itOut+=kernel(vvx,vvy)/sqrt(bandwidthX*bandwidthY);</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                <span class="comment">//std::cout&lt;&lt;x&lt;&lt;&quot;,&quot;&lt;&lt;y&lt;&lt;&quot;,&quot;&lt;&lt;vv&lt;&lt;*itOut&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>                x+=binwx;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>                ++itOut;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            }</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            y+=binwy;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>        }</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    }, firstX, lastX, firstY, lastY, kernel, bandwidthX, bandwidthY);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span> </div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span> </div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    {</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        <span class="keyword">auto</span> itOut=histogramImgOut;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> by=0; by&lt;ybins; by++) {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> bx=0; bx&lt;xbins; bx++) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                *itOut/=cnt;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>                ++itOut;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>            }</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        }</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    }</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>}</div>
</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span> </div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span><span class="comment"></span> </div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span><span class="comment">/*! \brief estimates a bandwidth for a 2-dimensional Kernel Density Estimator (KDE) of the given data \a first ... \a last using Scott&#39;s rule</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="comment">    \ingroup jkqtptools_math_statistics_2dkde</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span><span class="comment"></span> </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span><span class="comment">    evaluates \f[ h =  \hat{\sigma} n^{-1/(d+4)},\ \ \ \ \ d=2 \f]</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span><span class="comment"></span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span><span class="comment">    \tparam InputIt standard iterator type of \a first and \a last.</span></div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span><span class="comment">    \param first iterator pointing to the first item in the dataset to use \f$ X_1 \f$</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span><span class="comment">    \param last iterator pointing behind the last item in the dataset to use \f$ X_N \f$</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span><span class="comment">    \return the estimated bandwidth</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span><span class="comment"></span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span><span class="comment">    \see https://en.wikipedia.org/wiki/Multivariate_kernel_density_estimation#Rule_of_thumb</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span><span class="comment"></span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span><span class="comment">*/</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> InputIt&gt;</div>
<div class="foldopen" id="foldopen00629" data-start="{" data-end="}">
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">  629</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a>(InputIt first, InputIt last) {</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    <span class="keywordtype">size_t</span> N=0;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> sigma=<a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga0cbd4d4f762fe7c05fa143e643988c21">jkqtpstatStdDev</a>(first, last, <span class="keyword">nullptr</span>, &amp;N);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    <span class="keywordflow">return</span> sigma/pow(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(N), 1.0/(2.0+4.0));</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>}</div>
</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span> </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span> </div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span><span class="preprocessor">#endif </span><span class="comment">// JKQTPSTATKDE_H_INCLUDED</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span> </div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_ga4d3c8d42b6da8741d2fc400d93f8129b"><div class="ttname"><a href="group__jkqtptools__math__basic.html#ga4d3c8d42b6da8741d2fc400d93f8129b">JKQTPSTATISTICS_SQRT_2PI</a></div><div class="ttdeci">#define JKQTPSTATISTICS_SQRT_2PI</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:60</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_ga966c1a713f60bd026db4f35f7007eb7e"><div class="ttname"><a href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a></div><div class="ttdeci">constexpr double jkqtp_todouble(const T &amp;d)</div><div class="ttdoc">converts a boolean to a double, is used to convert boolean to double by JKQTPDatastore</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:113</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gacb0b84ffd616c54365266f907cedf400"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gacb0b84ffd616c54365266f907cedf400">jkqtp_sqr</a></div><div class="ttdeci">T jkqtp_sqr(const T &amp;v)</div><div class="ttdoc">returns the quare of the value v, i.e. v*v</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:327</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gacbbf91f431ae7c1a9a01ac1a4881491d"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gacbbf91f431ae7c1a9a01ac1a4881491d">jkqtp_cube</a></div><div class="ttdeci">T jkqtp_cube(T x)</div><div class="ttdoc">cube of a number</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:357</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gae96ac530dff57dae111b641b0c7f4eb4"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gae96ac530dff57dae111b641b0c7f4eb4">JKQTPSTATISTICS_PI</a></div><div class="ttdeci">#define JKQTPSTATISTICS_PI</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:52</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gaf0ace9f4ac87719798dea6ef64068ff4"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a></div><div class="ttdeci">bool JKQTPIsOKFloat(T v)</div><div class="ttdoc">check whether the dlotaing point number is OK (i.e. non-inf, non-NAN)</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:496</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_ga15b11fe1d910aae2516eb2ee291e337d"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga15b11fe1d910aae2516eb2ee291e337d">jkqtpstatKernel1DUniform</a></div><div class="ttdeci">double jkqtpstatKernel1DUniform(double t)</div><div class="ttdoc">a 1D uniform kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:85</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_ga389ecf091eea9940375ed53b2db611b0"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga389ecf091eea9940375ed53b2db611b0">jkqtpstatKernel1DCosine</a></div><div class="ttdeci">double jkqtpstatKernel1DCosine(double t)</div><div class="ttdoc">a 1D cosine kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:127</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_ga4b0be7c33c1924e20133c9cc991b92d4"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga4b0be7c33c1924e20133c9cc991b92d4">jkqtpstatKernel1DQuartic</a></div><div class="ttdeci">double jkqtpstatKernel1DQuartic(double t)</div><div class="ttdoc">a 1D quartic kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:102</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_ga814d88ca8155d903a6e667554d8ffc8e"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#ga814d88ca8155d903a6e667554d8ffc8e">jkqtpstatKernel1DTricube</a></div><div class="ttdeci">double jkqtpstatKernel1DTricube(double t)</div><div class="ttdoc">a 1D tricube kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:119</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gacd7acec82b29460d5c42b0f37d375399"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacd7acec82b29460d5c42b0f37d375399">jkqtpstatKernel1DTriweight</a></div><div class="ttdeci">double jkqtpstatKernel1DTriweight(double t)</div><div class="ttdoc">a 1D triweight kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:110</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gace17a03ec91b13f75dc324d3271b5966"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gace17a03ec91b13f75dc324d3271b5966">jkqtpstatKernel1DCauchy</a></div><div class="ttdeci">double jkqtpstatKernel1DCauchy(double t)</div><div class="ttdoc">a 1D Cauchy kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:60</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gacf48fe6890853c4592841ae85962d8ed"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacf48fe6890853c4592841ae85962d8ed">jkqtpstatKernel1DEpanechnikov</a></div><div class="ttdeci">double jkqtpstatKernel1DEpanechnikov(double t)</div><div class="ttdoc">a 1D Epanechnikov kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:77</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gadc261fe2e23128426ab9903e26a02885"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a></div><div class="ttdeci">double jkqtpstatKernel1DGaussian(double t)</div><div class="ttdoc">a 1D Gaussian kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:52</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gae1dfc12ace64c004d81f857ac889216d"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gae1dfc12ace64c004d81f857ac889216d">jkqtpstatKernel1DTriangle</a></div><div class="ttdeci">double jkqtpstatKernel1DTriangle(double t)</div><div class="ttdoc">a 1D Epanechnikov kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:93</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gaee8824008ed849cbb0c723966bfd2feb"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gaee8824008ed849cbb0c723966bfd2feb">jkqtpstatKernel1DPicard</a></div><div class="ttdeci">double jkqtpstatKernel1DPicard(double t)</div><div class="ttdoc">a 1D Picard kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:69</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde_html_ga2a72307b6aa56efce8d8b2baffeb9270"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde.html#ga2a72307b6aa56efce8d8b2baffeb9270">jkqtpstatKDE1DAutoranged</a></div><div class="ttdeci">void jkqtpstatKDE1DAutoranged(InputIt first, InputIt last, OutputIt KDEXOut, OutputIt KDEYOut, int Nout=100, const std::function&lt; double(double)&gt; &amp;kernel=std::function&lt; double(double)&gt;(&amp;jkqtpstatKernel1DGaussian), double bandwidth=1.0, bool cummulative=false)</div><div class="ttdoc">calculate an autoranged 1-dimensional Kernel Density Estimation (KDE) from the given data range first...</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:255</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde_html_ga6f694ee485a9939331ed0ef6fe423706"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a></div><div class="ttdeci">double jkqtpstatEstimateKDEBandwidth(InputIt first, InputIt last)</div><div class="ttdoc">estimates a bandwidth for a Kernel Density Estimator (KDE) of the given data first ....</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:192</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde_html_gaa05c4d4be2227655419d02a33bc834f5"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde.html#gaa05c4d4be2227655419d02a33bc834f5">jkqtpstatEvaluateKernelSum</a></div><div class="ttdeci">double jkqtpstatEvaluateKernelSum(double t, InputIt first, InputIt last, const std::function&lt; double(double)&gt; &amp;kernel, double bandwidth)</div><div class="ttdoc">evaluates the Kernel Density Estimator (KDE) at a given position</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:215</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde_html_gaea1ca0066c61947e8a8a7d8deaa36d3e"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde.html#gaea1ca0066c61947e8a8a7d8deaa36d3e">jkqtpstatKDE1D</a></div><div class="ttdeci">void jkqtpstatKDE1D(InputIt first, InputIt last, BinsInputIt binsFirst, BinsInputIt binsLast, OutputIt KDEXOut, OutputIt KDEYOut, const std::function&lt; double(double)&gt; &amp;kernel=std::function&lt; double(double)&gt;(&amp;jkqtpstatKernel1DGaussian), double bandwidth=1.0, bool cummulative=false)</div><div class="ttdoc">calculate an autoranged 1-dimensional Kernel Density Estimation (KDE) from the given data range first...</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:368</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde__kernels_html_ga90e986c268fabfddc394b61adecc6ea2"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde__kernels.html#ga90e986c268fabfddc394b61adecc6ea2">jkqtpstatKernel2DUniform</a></div><div class="ttdeci">double jkqtpstatKernel2DUniform(double tx, double ty)</div><div class="ttdoc">a 2D Uniform kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:158</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde__kernels_html_gaba5d115fd8be2d295419818be380b277"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">jkqtpstatKernel2DGaussian</a></div><div class="ttdeci">double jkqtpstatKernel2DGaussian(double tx, double ty)</div><div class="ttdoc">a 2D Gaussian kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:148</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_ga5a942e00c033a0125cbd6991be062e08"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#ga5a942e00c033a0125cbd6991be062e08">jkqtpstatEvaluateKernelSum2D</a></div><div class="ttdeci">double jkqtpstatEvaluateKernelSum2D(double x, double y, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, const std::function&lt; double(double, double)&gt; &amp;kernel, double bandwidthX, double bandwidthY)</div><div class="ttdoc">evaluates the Kernel Density Estimator (KDE) at a given position</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:480</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_ga6180cc1b0cb92cbe75e2594b657cff24"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#ga6180cc1b0cb92cbe75e2594b657cff24">jkqtpstatStoreKernelSum2D</a></div><div class="ttdeci">int jkqtpstatStoreKernelSum2D(FF &amp;&amp;fStore, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, const std::function&lt; double(double, double)&gt; &amp;kernel, double bandwidthX, double bandwidthY)</div><div class="ttdoc">stores a part-result of the Kernel Density Estimator (KDE) at a given position</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:526</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_gabea5faa220697a680179e0460ab6a46d"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d">jkqtpstatKDE2D</a></div><div class="ttdeci">void jkqtpstatKDE2D(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, OutputIt histogramImgOut, double xmin, double xmax, double ymin, double ymax, size_t xbins, size_t ybins, const std::function&lt; double(double, double)&gt; &amp;kernel=std::function&lt; double(double, double)&gt;(&amp;jkqtpstatKernel2DGaussian), double bandwidthX=1.0, double bandwidthY=1.0)</div><div class="ttdoc">calculate an autoranged 2-dimensional Kernel Density Estimation (KDE) from the given data range first...</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:566</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_gad32be3dbb22fb9a1c9af695dba13ca43"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a></div><div class="ttdeci">double jkqtpstatEstimateKDEBandwidth2D(InputIt first, InputIt last)</div><div class="ttdoc">estimates a bandwidth for a 2-dimensional Kernel Density Estimator (KDE) of the given data first ....</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:629</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__basic_html_ga0cbd4d4f762fe7c05fa143e643988c21"><div class="ttname"><a href="group__jkqtptools__math__statistics__basic.html#ga0cbd4d4f762fe7c05fa143e643988c21">jkqtpstatStdDev</a></div><div class="ttdeci">double jkqtpstatStdDev(InputIt first, InputIt last, double *averageOut=nullptr, size_t *Noutput=nullptr)</div><div class="ttdoc">calculates the standard deviation  of a given data range first ... last</div><div class="ttdef"><b>Definition</b> jkqtpstatbasics.h:515</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__basic_html_ga88686b7d786896c704659dc8fe4c1e7f"><div class="ttname"><a href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a></div><div class="ttdeci">void jkqtpstatMinMax(InputIt first, InputIt last, double &amp;min, double &amp;max, InputIt *minPos=nullptr, InputIt *maxPos=nullptr, size_t *Noutput=nullptr)</div><div class="ttdoc">calculates the minimum and maximum values in the given data range first ... last</div><div class="ttdef"><b>Definition</b> jkqtpstatbasics.h:168</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a href="dir_41b64d01ba73fd10a3db4d8d86d562c2.html">jkqtmath</a></li><li class="navelem"><b>jkqtpstatkde.h</b></li>
    <li class="footer">Generated on <span class="timestamp"></span> for JKQTPlotter by <a href="https://www.doxygen.org/index.html">doxygen</a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
