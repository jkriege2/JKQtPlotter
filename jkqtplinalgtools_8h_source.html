<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JKQTPlotter: jkqtplinalgtools.h Source File</title>
<meta name="description" content="an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies">
<meta name="keywords" lang="en-us" content="C++, C++11, Qt, Qt5, Qt6, Plotting, Plot, Chart, Graph, Qt, Widget, C++, Library, Visualization, charting library, plotting library, scientific visualization, data visualization, statistics, statistical methods, statistics library, LaTeX parser, LaTeX renderer, Qt widget, Qt5 widget, Qt6 widget, Qt charts, Qt plots, barchart, violinplot, boxplot, JKQtPlotter, JKQTMathText, JKQTFastPlotter">
<meta name="author" content="$author">
<meta name="copyright" content="(c) 2008-2022 by $author">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="jkqtplotter_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_doxygen.png"/></td>
  <td id="projectalign">
   <div id="projectname">JKQTPlotter<span id="projectnumber">&#160;trunk/v5.0.0</span>
   </div>
   <div id="projectbrief">an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<div id="main-nav">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- main-nav -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('jkqtplinalgtools_8h_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">jkqtplinalgtools.h</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">    Copyright (c) 2008-2024 Jan W. Krieger (&lt;jan@jkrieger.de&gt;)</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"></span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">    last modification: $LastChangedDate$  (revision $Rev$)</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"></span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">    This software is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">    it under the terms of the GNU Lesser General Public License (LGPL) as published by</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">    the Free Software Foundation, either version 2.1 of the License, or</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">    (at your option) any later version.</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"></span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">    This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">    GNU Lesser General Public License (LGPL) for more details.</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"></span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">    You should have received a copy of the GNU Lesser General Public License (LGPL)</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">*/</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#ifndef JKQTPLINALGTOOLS_H_INCLUDED</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#define JKQTPLINALGTOOLS_H_INCLUDED</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;ostream&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;jkqtmath/jkqtmath_imexport.h&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;jkqtmath/jkqtparraytools.h&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;jkqtcommon/jkqtpmathtools.h&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;jkqtcommon/jkqtpstringtools.h&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor"># include &lt;omp.h&gt;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#ifndef JKQTP_ALIGNMENT_BYTES</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#define JKQTP_ALIGNMENT_BYTES 32</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#ifdef JKQTP_STATISTICS_TOOLS_MAY_USE_EIGEN3</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#  include &lt;Eigen/Core&gt;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#  include &lt;Eigen/SVD&gt;</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#  include &lt;Eigen/Jacobi&gt;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#  include &lt;Eigen/LU&gt;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#  include &lt;Eigen/QR&gt;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment"></span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment">/** \brief calculate the index of the entry in line \a l and column \a c</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment"> *         in a row-major matrix with \a C columns</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="comment"> *</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="comment"> * You can use this to access a matrix with L rows and C columns:</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment"> * \code</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="comment"> *     for (long l=0; l&lt;L; l++) {</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="comment"> *       for (long c=0; c&lt;C; c++) {</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="comment"> *         matrix[jkqtplinalgMatIndex(l,c,C)=0;</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment"> *         if (l==c) matrix[jkqtplinalgMatIndex(l,c,C)=1;</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment"> *       }</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment"> *     }</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="comment"> * \endcode</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="comment"> */</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">   79</a></span><span class="preprocessor">#define jkqtplinalgMatIndex(l,c,C) ((l)*(C)+(c))</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="comment"></span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="comment">/** \brief print the given LxC matrix to std::cout</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment"> *</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="comment"> *  \tparam type of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="comment"> *  \param matrix the matrix to print out</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="comment"> *  \param L number of lines/rows in the matrix</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="comment"> *  \param C number of columns in the matrix</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="comment"> *  \param width width (in characters) of each cell in the output (used for formatting)</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="comment"> *  \param precision precision (in digits) for string-conversions in the output (used for formatting)</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="comment"> *  \param mode if \c ==&#39;f&#39; the mode \c std::fixed is used for output, otherwise \c std::scientific is used</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="comment">*/</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00094" data-start="{" data-end="}">
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga68f4af6bad95143a744a1cd99a3ffeec">   94</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga68f4af6bad95143a744a1cd99a3ffeec">jkqtplinalgPrintMatrix</a>(<span class="keyword">const</span> T* matrix, <span class="keywordtype">long</span> L, <span class="keywordtype">long</span> C, <span class="keywordtype">int</span> width=9, <span class="keywordtype">int</span> precision=3, <span class="keywordtype">char</span> mode=<span class="charliteral">&#39;f&#39;</span>) {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;L; l++) {</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;C; c++) {</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>            <span class="keywordflow">if</span> (c&gt;0) std::cout&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            std::cout.precision(precision);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            std::cout.width(width);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>            <span class="keywordflow">if</span> (mode==<span class="charliteral">&#39;f&#39;</span>) std::cout&lt;&lt;std::fixed&lt;&lt;std::right&lt;&lt;matrix[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,C)];</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            <span class="keywordflow">else</span> std::cout&lt;&lt;std::scientific&lt;&lt;std::right&lt;&lt;matrix[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,C)];</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        }</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>        std::cout&lt;&lt;std::endl;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    }</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>}</div>
</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="comment"></span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="comment">/** \brief convert the given LxC matrix to std::string</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="comment"> *</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="comment"> *  \tparam type of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span><span class="comment"> *  \param matrix the matrix to convert</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="comment"> *  \param L number of lines/rows in the matrix</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span><span class="comment"> *  \param C number of columns in the matrix</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="comment"> *  \param width width (in characters) of each cell in the output (used for formatting)</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="comment"> *  \param precision precision (in digits) for string-conversions in the output (used for formatting)</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="comment"> *  \param mode the (printf()) string conversion mode for output of the cell values</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span><span class="comment">*/</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00121" data-start="{" data-end="}">
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga3e196152acbf4f8dfe3c33abb0af62a7">  121</a></span><span class="keyword">inline</span> std::string <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga3e196152acbf4f8dfe3c33abb0af62a7">jkqtplinalgMatrixToString</a>(T* matrix, <span class="keywordtype">long</span> L, <span class="keywordtype">long</span> C, <span class="keywordtype">int</span> width=9, <span class="keywordtype">int</span> precision=3, <span class="keyword">const</span> std::string&amp; mode=std::string(<span class="stringliteral">&quot;g&quot;</span>)) {</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    std::string format=<span class="stringliteral">&quot;%&quot;</span>+<a class="code hl_function" href="group__jkqtptools__string.html#ga25069128d19d112ba61d6fad739f6379">jkqtp_inttostr</a>(width)+std::string(<span class="stringliteral">&quot;.&quot;</span>)+<a class="code hl_function" href="group__jkqtptools__string.html#ga25069128d19d112ba61d6fad739f6379">jkqtp_inttostr</a>(precision)+std::string(<span class="stringliteral">&quot;l&quot;</span>)+mode;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    std::ostringstream ost;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;L; l++) {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;C; c++) {</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>            <span class="keywordflow">if</span> (c&gt;0) ost&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>            <span class="keywordtype">char</span> buf[500];</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            snprintf(buf, 500, format.c_str(), <a class="code hl_function" href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a>(matrix[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,C)]));</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>            ost&lt;&lt;buf;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>            <span class="comment">/*ost.precision(precision);</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="comment">            ost.width(width);</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span><span class="comment">            if (mode==&#39;f&#39;) ost&lt;&lt;std::fixed&lt;&lt;std::right&lt;&lt;matrix[jkqtplinalgMatIndex(l,c,C)];</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span><span class="comment">            else ost&lt;&lt;std::scientific&lt;&lt;std::right&lt;&lt;matrix[jkqtplinalgMatIndex(l,c,C)];*/</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        }</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        ost&lt;&lt;std::endl;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    }</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="keywordflow">return</span> ost.str();</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>}</div>
</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span><span class="comment"></span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span><span class="comment">/** \brief maps the number range -1 ... +1 to a color-scale lightblue - white - lightred (used for coloring matrices!)</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span><span class="comment"> *</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span><span class="comment"> *  \param val the value to convert</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="comment"> *  \param[out] r returns the red value (0..255)</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="comment"> *  \param[out] g returns the green value (0..255)</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="comment"> *  \param[out] b returns the blue value (0..255)</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00149" data-start="{" data-end="}">
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">  149</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(<span class="keywordtype">double</span> val, uint8_t&amp; r, uint8_t&amp; g, uint8_t&amp; b){</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    r=255;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    g=255;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    b=255;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> fval=fabs(val);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <span class="keywordflow">if</span> (val&lt;0 &amp;&amp; val&gt;=-1) {</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>        r=<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaba414891ee7a449b462aaaff0a35635f">jkqtp_boundedRoundTo&lt;uint8_t&gt;</a>(0,255.0-fval*127.0,255);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        g=<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaba414891ee7a449b462aaaff0a35635f">jkqtp_boundedRoundTo&lt;uint8_t&gt;</a>(0,255.0-fval*127.0,255);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val&gt;0 &amp;&amp; val&lt;=1) {</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        b=<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaba414891ee7a449b462aaaff0a35635f">jkqtp_boundedRoundTo&lt;uint8_t&gt;</a>(0,255.0-fval*127.0,255);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        g=<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaba414891ee7a449b462aaaff0a35635f">jkqtp_boundedRoundTo&lt;uint8_t&gt;</a>(0,255.0-fval*127.0,255);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val&lt;-1) {</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        r=127;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        g=127;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        b=255;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val&gt;1) {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        r=255;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        g=127;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        b=127;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>}</div>
</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="comment"></span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span><span class="comment">/** \brief maps the number range -1 ... +1 to a non-linear color-scale lightblue - white - lightred (used for coloring matrices!)</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span><span class="comment"> *</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span><span class="comment"> *  \param val the value to convert</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span><span class="comment"> *  \param[out] r returns the red value (0..255)</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span><span class="comment"> *  \param[out] g returns the green value (0..255)</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="comment"> *  \param[out] b returns the blue value (0..255)</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="comment"> *  \param gamma a gamma-value for non-linear color scaling</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="comment">*/</span></div>
<div class="foldopen" id="foldopen00180" data-start="{" data-end="}">
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">  180</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a>(<span class="keywordtype">double</span> val, uint8_t&amp; r, uint8_t&amp; g, uint8_t&amp; b, <span class="keywordtype">double</span> gamma=0.5){</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <span class="keywordflow">if</span> (val&lt;0) {</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(-1.0*pow(-val,gamma),r,g,b);</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(pow(val,gamma),r,g,b);</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    }</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>}<span class="comment"></span></div>
</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span><span class="comment">/** \brief convert the given LxC matrix to std::string, encoded as HTML table</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span><span class="comment"> *</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="comment"> *</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="comment"> *  \tparam type of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="comment"> *  \param matrix the matrix to convert</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="comment"> *  \param L number of lines/rows in the matrix</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="comment"> *  \param C number of columns in the matrix</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="comment"> *  \param width width (in characters) of each cell in the output (used for formatting)</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="comment"> *  \param precision precision (in digits) for string-conversions in the output (used for formatting)</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="comment"> *  \param mode the (printf()) string conversion mode for output of the cell values</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span><span class="comment"> *  \param tableformat this is inserted into the \c &lt;table...&gt; tag (may contain HTML property definitions)</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="comment"> *  \param prenumber this is inserted before each number (may contain HTML markup)</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="comment"> *  \param postnumber this is inserted after each number (may contain HTML markup)</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="comment"> *  \param colorcoding if \c true, teh cell backgrounds are color-coded</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span><span class="comment"> *  \param zeroIsWhite if \c the color-coding is forced to white for 0 and then encodes in positive/negative direction with colors (red and blue)</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span><span class="comment"> *  \param[out] colorlabel outputs a label explaining the auto-generated color-coding</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span><span class="comment"> *  \param nonlinColors if \c true, a non-linear color-coding is used</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span><span class="comment"> *  \param nonlinColorsGamma gamma-value for a non-linear color-coding</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span><span class="comment"> *  \param colortableformat  lie \a tableformat, but for the legend table output in \a colorLabel</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span><span class="comment"> *</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span><span class="comment"> * \see jkqtplinalgPM1ToNonlinRWBColors() and jkqtplinalgPM1ToRWBColors()</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="comment">*/</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00211" data-start="{" data-end="}">
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga4e462736a9bb361592fcb3c0832bfa0e">  211</a></span><span class="keyword">inline</span> std::string <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga4e462736a9bb361592fcb3c0832bfa0e">jkqtplinalgMatrixToHTMLString</a>(T* matrix, <span class="keywordtype">long</span> L, <span class="keywordtype">long</span> C, <span class="keywordtype">int</span> width=9, <span class="keywordtype">int</span> precision=3, <span class="keyword">const</span> std::string&amp; mode=std::string(<span class="stringliteral">&quot;g&quot;</span>), <span class="keyword">const</span> std::string&amp; tableformat=std::string(), <span class="keyword">const</span> std::string&amp; prenumber=std::string(), <span class="keyword">const</span> std::string&amp; postnumber=std::string(), <span class="keywordtype">bool</span> colorcoding=<span class="keyword">false</span>, <span class="keywordtype">bool</span> zeroIsWhite=<span class="keyword">true</span>, std::string* colorlabel=<span class="keyword">nullptr</span>, <span class="keywordtype">bool</span> nonlinColors=<span class="keyword">false</span>, <span class="keywordtype">double</span> nonlinColorsGamma=0.25, <span class="keyword">const</span> std::string&amp; colortableformat=std::string()) {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    std::ostringstream ost;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    ost&lt;&lt;<span class="stringliteral">&quot;&lt;table &quot;</span>&lt;&lt;tableformat&lt;&lt;<span class="stringliteral">&quot;&gt;\n&quot;</span>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    std::string format=<span class="stringliteral">&quot;%&quot;</span>+<a class="code hl_function" href="group__jkqtptools__string.html#ga25069128d19d112ba61d6fad739f6379">jkqtp_inttostr</a>(width)+std::string(<span class="stringliteral">&quot;.&quot;</span>)+<a class="code hl_function" href="group__jkqtptools__string.html#ga25069128d19d112ba61d6fad739f6379">jkqtp_inttostr</a>(precision)+std::string(<span class="stringliteral">&quot;l&quot;</span>)+mode;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    <span class="keywordtype">double</span> minv=0, maxv=0;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <span class="keywordflow">if</span> (colorcoding) {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>        <a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(matrix, L*C, minv, maxv);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;L; l++) {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        ost&lt;&lt;<span class="stringliteral">&quot;  &lt;tr&gt;&quot;</span>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;C; c++) {</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> val=matrix[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,C)];</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            std::string cols=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            <span class="keywordflow">if</span> (colorcoding) {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                <span class="keywordtype">double</span> valrel=0;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                uint8_t r=255,g=255,b=255;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>                <span class="keywordflow">if</span> (zeroIsWhite){</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                    <span class="keywordflow">if</span> (val&lt;0) valrel=-1.0*fabs(val/minv);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                    <span class="keywordflow">if</span> (val&gt;0) valrel=fabs(val/maxv);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                    valrel=((val-minv)/(maxv-minv)-0.5)*2.0;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>                }</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>                <span class="keywordflow">if</span> (nonlinColors) {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>                    <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a>(valrel, r,g,b, nonlinColorsGamma);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>                    <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(valrel, r,g,b);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>                }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                <span class="keywordtype">char</span> buf[500];</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                snprintf(buf, 500, <span class="stringliteral">&quot; bgcolor=\&quot;#%02X%02X%02X\&quot;&quot;</span>, <span class="keywordtype">int</span>(r), <span class="keywordtype">int</span>(g), <span class="keywordtype">int</span>(b));</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                cols=buf;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            }</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            ost&lt;&lt;<span class="stringliteral">&quot;&lt;td align=\&quot;center\&quot; valign=\&quot;middle\&quot; width=\&quot;&quot;</span>&lt;&lt;(100.0/double(C))&lt;&lt;<span class="stringliteral">&quot;%\&quot; &quot;</span>&lt;&lt;cols&lt;&lt;<span class="stringliteral">&quot;&gt;&lt;nobr&gt;&quot;</span>;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>            ost.precision(precision);</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            ost.width(width);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            <span class="keywordtype">char</span> buf[500];</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            snprintf(buf, 500, format.c_str(), val);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            ost&lt;&lt;prenumber&lt;&lt;buf&lt;&lt;postnumber;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            ost&lt;&lt;<span class="stringliteral">&quot;&lt;/nobr&gt;&lt;/td&gt;&quot;</span>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        ost&lt;&lt;<span class="stringliteral">&quot;&lt;/tr&gt;\n&quot;</span>;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    }</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    ost&lt;&lt;<span class="stringliteral">&quot;&lt;/table&gt;&quot;</span>;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="keywordflow">if</span> (colorcoding &amp;&amp; colorlabel) {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        <span class="keywordtype">char</span> buf[8192];</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        uint8_t rm=255,gm=255,bm=255;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>        uint8_t rmc=255,gmc=255,bmc=255;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        uint8_t rc=255,gc=255,bc=255;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        uint8_t rcp=255,gcp=255,bcp=255;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        uint8_t rp=255,gp=255,bp=255;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <span class="keywordtype">double</span> vm=minv;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>        <span class="keywordtype">double</span> vc=0;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        <span class="keywordtype">double</span> vp=maxv;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <span class="keywordflow">if</span> (!zeroIsWhite) {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            vc=(maxv+minv)/2.0;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        }</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        <span class="keywordflow">if</span> (nonlinColors) {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a>(-1, rm, gm, bm, nonlinColorsGamma);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a>(-0.5, rmc, gmc, bmc, nonlinColorsGamma);</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a>(0, rc, gc, bc, nonlinColorsGamma);</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a>(0.5, rcp, gcp, bcp, nonlinColorsGamma);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a>(1, rp, gp, bp, nonlinColorsGamma);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(-1, rm, gm, bm);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(-0.5, rmc, gmc, bmc);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(0, rc, gc, bc);</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(0.5, rcp, gcp, bcp);</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>            <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a>(1, rp, gp, bp);</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        snprintf(buf, 8192, <span class="stringliteral">&quot;&lt;table %s cellpadding=\&quot;2\&quot; cellspacing=\&quot;0\&quot; border=\&quot;1\&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;table width=\&quot;100%%\&quot; cellpadding=\&quot;3\&quot; cellspacing=\&quot;0\&quot; border=\&quot;0\&quot;&gt;&lt;tr&gt;&quot;</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                     <span class="stringliteral">&quot;&lt;td bgcolor=\&quot;#%02X%02X%02X\&quot; width=\&quot;20%%\&quot;&gt;&lt;nobr&gt;&amp;nbsp;%9.3lg&amp;nbsp;&lt;/nobr&gt;&lt;/td&gt;&quot;</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                     <span class="stringliteral">&quot;&lt;td bgcolor=\&quot;#%02X%02X%02X\&quot; width=\&quot;20%%\&quot;&gt;&lt;nobr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;mdash;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/nobr&gt;&lt;/td&gt;&quot;</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>                     <span class="stringliteral">&quot;&lt;td bgcolor=\&quot;#%02X%02X%02X\&quot; width=\&quot;20%%\&quot;&gt;&lt;nobr&gt;&amp;nbsp;%9.3lg&amp;nbsp;&lt;/nobr&gt;&lt;/td&gt;&quot;</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>                     <span class="stringliteral">&quot;&lt;td bgcolor=\&quot;#%02X%02X%02X\&quot; width=\&quot;20%%\&quot;&gt;&lt;nobr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;mdash;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/nobr&gt;&lt;/td&gt;&quot;</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                     <span class="stringliteral">&quot;&lt;td bgcolor=\&quot;#%02X%02X%02X\&quot; width=\&quot;20%%\&quot;&gt;&lt;nobr&gt;&amp;nbsp;%9.3lg&amp;nbsp;&lt;/nobr&gt;&lt;/td&gt;&quot;</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>                     <span class="stringliteral">&quot;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span>, colortableformat.c_str(), <span class="keywordtype">int</span>(rm), <span class="keywordtype">int</span>(gm), <span class="keywordtype">int</span>(bm), vm, <span class="keywordtype">int</span>(rmc), <span class="keywordtype">int</span>(gmc), <span class="keywordtype">int</span>(bmc), <span class="keywordtype">int</span>(rc), <span class="keywordtype">int</span>(gc), <span class="keywordtype">int</span>(bc), vc, <span class="keywordtype">int</span>(rcp), <span class="keywordtype">int</span>(gcp), <span class="keywordtype">int</span>(bcp), <span class="keywordtype">int</span>(rp), <span class="keywordtype">int</span>(gp), <span class="keywordtype">int</span>(bp), vp);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        (*colorlabel)=std::string(buf);</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    }</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    <span class="keywordflow">return</span> ost.str();</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>}</div>
</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment"></span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="comment">/** \brief dot-product between two vectors \a vec1 and \a vec2, each with a length of \a N entries</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment">  * \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="comment">  *</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span><span class="comment">  *  \tparam T of the vector cells (typically double or float)</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="comment">  *  \param vec1 first vector</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span><span class="comment">  *  \param vec2 second vector</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="comment">  *  \param N number of entries in \a vec1 and \a vec2</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">  */</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00301" data-start="{" data-end="}">
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#gad513c7870f8d9c7ea57fab1588a1ecab">  301</a></span><span class="keyword">inline</span> T <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gad513c7870f8d9c7ea57fab1588a1ecab">jkqtplinalgDotProduct</a>(<span class="keyword">const</span> T* vec1, <span class="keyword">const</span> T* vec2, <span class="keywordtype">long</span> N) {</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    T res=0;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;N; l++) {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        res=res+vec1[l]*vec2[l];</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    }</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>}</div>
</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span><span class="comment"></span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="comment">/** \brief transpose the given NxN matrix</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="comment"> *</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="comment"> *  \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="comment"> *  \param matrix the matrix to transpose</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="comment"> *  \param N number of rows and columns in the matrix</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span><span class="comment"> *</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="comment"> */</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00319" data-start="{" data-end="}">
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga36e5b138c96b8ae51452dc364c54dd0e">  319</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga36e5b138c96b8ae51452dc364c54dd0e">jkqtplinalgTransposeMatrix</a>(T* matrix, <span class="keywordtype">long</span> N) {</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;N; l++) {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=l+1; c&lt;N; c++) {</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            <a class="code hl_function" href="group__jkqtptools__math__array.html#ga3e8ffdc0989b2c229973cab00543825d">jkqtpArraySwap</a>(matrix, <a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,N), <a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(c,l,N));</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        }</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    }</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>}</div>
</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span><span class="comment"></span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span><span class="comment">/** \brief transpose the given LxC matrix</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="comment"> *</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment"> *  \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="comment"> *  \param matrix the matrix to transpose</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="comment"> *  \param L number of rows in the matrix</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span><span class="comment"> *  \param C number of columns in the matrix</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span><span class="comment"> *</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span><span class="comment"> *  \note  The output is interpreted as CxL matrix!!!</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span><span class="comment"> */</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00339" data-start="{" data-end="}">
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga2554dec876332cc2689da26404c265a4">  339</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga36e5b138c96b8ae51452dc364c54dd0e">jkqtplinalgTransposeMatrix</a>(T* matrix, <span class="keywordtype">long</span> L, <span class="keywordtype">long</span> C) {</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <a class="code hl_class" href="class_j_k_q_t_p_array_scoped_pointer.html">JKQTPArrayScopedPointer&lt;T&gt;</a> t(<a class="code hl_function" href="group__jkqtptools__math__array.html#ga3ee1bf982092f55f4e1d1f684aa20ea5">jkqtpArrayDuplicate&lt;T&gt;</a>(matrix, L*C));</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;L; l++) {</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;C; c++) {</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>            matrix[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(c,l,L)]=t[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,C)];</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        }</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    }</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>}</div>
</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span><span class="comment"></span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment">/** \brief swap two lines in a matrix</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment"> *  \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment"> *</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment"> *  \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment"> *  \param m the matrix to work on</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="comment"> *  \param l1 the row to swap with row \a l2</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="comment"> *  \param l2 the row to swap with row \a l1</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="comment"> *  \param C number of columns in the matrix</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="comment">*/</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00358" data-start="{" data-end="}">
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#gab2a17f4ddff10bdef87b625278238ac2">  358</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab2a17f4ddff10bdef87b625278238ac2">jkqtplinalgMatrixSwapLines</a>(T* m, <span class="keywordtype">long</span> l1, <span class="keywordtype">long</span> l2, <span class="keywordtype">long</span> C) {</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;C; c++) {</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        <a class="code hl_function" href="group__jkqtptools__math__array.html#ga3e8ffdc0989b2c229973cab00543825d">jkqtpArraySwap</a>(m, <a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l1, c, C), <a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l2, c, C));</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    }</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>}</div>
</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment"></span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="comment">/*! \brief matrix-matrix product</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment"></span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">   \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span><span class="comment">    \param M1 matrix 1, size: L1xC1</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment">    \param L1 number of rows in the matrix \a M1</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span><span class="comment">    \param C1 number of columns in the matrix \a M1</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="comment">    \param M2 matrix 1, size: L2xC2</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span><span class="comment">    \param L2 number of rows in the matrix \a M2</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span><span class="comment">    \param C2 number of columns in the matrix \a M2</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="comment">    \param[out] M output matrix M=M1*M2, size: L1xC2</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="comment">*/</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00378" data-start="{" data-end="}">
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">  378</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">jkqtplinalgMatrixProduct</a>(<span class="keyword">const</span> T* M1, <span class="keywordtype">long</span> L1, <span class="keywordtype">long</span> C1, <span class="keyword">const</span> T* M2, <span class="keywordtype">long</span> L2, <span class="keywordtype">long</span> C2, T* M) {</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="keywordflow">if</span> (M1!=M &amp;&amp;M2!=M) {</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;L1; l++) {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>            <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;C2; c++) {</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>                <span class="keywordtype">double</span> s=T(0);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>                <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;C1; i++) {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>                    s = s + M1[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l, i, C1)]*M2[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(i,c, C2)];</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>                }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>                M[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l, c, C2)]=s;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>            }</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        }</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (M1==M &amp;&amp; M2!=M) {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        <a class="code hl_class" href="class_j_k_q_t_p_array_scoped_pointer.html">JKQTPArrayScopedPointer&lt;T&gt;</a> MM(<a class="code hl_function" href="group__jkqtptools__math__array.html#ga3ee1bf982092f55f4e1d1f684aa20ea5">jkqtpArrayDuplicate</a>(M1, L1*C1));</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">jkqtplinalgMatrixProduct</a>(MM.<a class="code hl_function" href="class_j_k_q_t_p_array_scoped_pointer.html#ad87fcbc397ab2f51b17fc6db49aacf31">data</a>(),L1,C1,M2,L2,C2,M);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (M1!=M &amp;&amp; M2==M) {</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        <a class="code hl_class" href="class_j_k_q_t_p_array_scoped_pointer.html">JKQTPArrayScopedPointer&lt;T&gt;</a> MM(<a class="code hl_function" href="group__jkqtptools__math__array.html#ga3ee1bf982092f55f4e1d1f684aa20ea5">jkqtpArrayDuplicate</a>(M1, L1*C1));</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">jkqtplinalgMatrixProduct</a>(M1,L1,C1,MM.<a class="code hl_function" href="class_j_k_q_t_p_array_scoped_pointer.html#ad87fcbc397ab2f51b17fc6db49aacf31">data</a>(),L2,C2,M);</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (M1==M &amp;&amp; M2==M) {</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        <a class="code hl_class" href="class_j_k_q_t_p_array_scoped_pointer.html">JKQTPArrayScopedPointer&lt;T&gt;</a> MM(<a class="code hl_function" href="group__jkqtptools__math__array.html#ga3ee1bf982092f55f4e1d1f684aa20ea5">jkqtpArrayDuplicate</a>(M1, L1*C1));</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">jkqtplinalgMatrixProduct</a>(MM.<a class="code hl_function" href="class_j_k_q_t_p_array_scoped_pointer.html#ad87fcbc397ab2f51b17fc6db49aacf31">data</a>(),L1,C1,MM.<a class="code hl_function" href="class_j_k_q_t_p_array_scoped_pointer.html#ad87fcbc397ab2f51b17fc6db49aacf31">data</a>(),L2,C2,M);</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>}</div>
</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="comment"></span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span><span class="comment">/*! \brief matrix-matrix product of two NxN matrices</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span><span class="comment"></span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span><span class="comment">    \param M1 matrix 1, size: NxN</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span><span class="comment">    \param M2 matrix 1, size: NxN</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span><span class="comment">    \param N number os rows/columns in the matrices \a M1, \a M2 and \a M</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span><span class="comment">    \param[out] M output matrix M=M1*M2, size: NxN</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span><span class="comment">*/</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00412" data-start="{" data-end="}">
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga1bccfeecb8e9df27d172f98a26e65c85">  412</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">jkqtplinalgMatrixProduct</a>(<span class="keyword">const</span> T* M1, <span class="keyword">const</span> T* M2, <span class="keywordtype">long</span> N, T* M) {</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">jkqtplinalgMatrixProduct</a>(M1,N,N,M2,N,N,M);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>}</div>
</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span><span class="comment"></span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span><span class="comment">/*! \brief performs a Gauss-Jordan eliminaion on a LxC matrix m</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span><span class="comment"></span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span><span class="comment">    For a matrix equation \f[ A\cdot\vec{x}=\vec{b} \f] the input matrix is \f[ \left[A | \vec{b}\right] \f] for matrix inversion it is</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span><span class="comment">    \f[ \left[A | I_L\right] \f] where \f$ I_L \f$ is the unit matrix with LxL entries.</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span><span class="comment"></span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span><span class="comment">    \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span><span class="comment">    \param m the matrix</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span><span class="comment">    \param L number of rows in the matrix</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span><span class="comment">    \param C number of columns in the matrix</span></div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span><span class="comment"></span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span><span class="comment">    \see http://www.virtual-maxim.de/matrix-invertieren-in-c-plus-plus/</span></div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span><span class="comment">*/</span></div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00435" data-start="{" data-end="}">
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga38c91e3f5648e6b68fce05ddeaeba3a1">  435</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga38c91e3f5648e6b68fce05ddeaeba3a1">jkqtplinalgGaussJordan</a>(T* m, <span class="keywordtype">long</span> L, <span class="keywordtype">long</span> C) {</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> N=L;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <span class="comment">//std::cout&lt;&lt;&quot;\nstep 0:\n&quot;;</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="comment">//linalgPrintMatrix(m, N, C);</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="comment">// first we perform a Gauss-elimination, which transforms the  matrix in the left half of m into upper triangular form</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;N-1; k++) {</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <span class="comment">//std::cout&lt;&lt;&quot;\nstep G&quot;&lt;&lt;k&lt;&lt;&quot;: pivot=&quot;&lt;&lt;m[jkqtpstatisticsMatIndex(k,k,C)]&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        <span class="keywordflow">if</span> (m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,k,C)]==0.0) {</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>            <span class="comment">// if pivot(m[k,k])==0, then swap this line with a line, which does not have a 0 in the k-th column</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>            <span class="keywordflow">for</span> (<span class="keywordtype">long</span> ks=k+1; ks&lt;N; ks++) {</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>                <span class="keywordflow">if</span> (m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(ks,k,C)]!=0.0) {</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>                    <a class="code hl_function" href="group__jkqtptools__math__linalg.html#gab2a17f4ddff10bdef87b625278238ac2">jkqtplinalgMatrixSwapLines</a>(m, ks, k, C);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ks==N-1) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>                    <span class="comment">// if no such element is found, the matrix may not be inverted!</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>                }</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>            }</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>        }</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        <span class="comment">// now we can eliminate all entries i below the pivot line p, by subtracting</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="comment">// the pivot line, scaled by s, from every line, where</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        <span class="comment">// s=m[i,p]/m[p,p]</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=k+1; i&lt;N; i++) {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            <span class="keyword">const</span> T s=m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(i,k,C)]/m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,k,C)];</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>            <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=k; c&lt;C; c++) {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>                m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(i,c,C)] -= m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c,C)]*s;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>            }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        }</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        <span class="comment">//linalgPrintMatrix(m, N, C);</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    }</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span> </div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="comment">// now we can caluate the determinant of the left half-matrix, which can be used to determine, whether matrix</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <span class="comment">// is invertible at all: if det(T)==0.0 -&gt; matrix is not invertible</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="comment">// the determinant of an upper triangular marix equals the product of the diagonal elements</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    T det=1.0;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;N; k++) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        det = det * m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,k,C)];</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>    }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    <span class="comment">//linalgPrintMatrix(m, N, C);</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    <span class="comment">//std::cout&lt;&lt;&quot;\nstep 2:  det(M)=&quot;&lt;&lt;det&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    <span class="keywordflow">if</span> (fabs(det)&lt;DBL_MIN*10.0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span> </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <span class="comment">// if the matrix may be inverted, we can go on with the JOrdan part of the algorithm:</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <span class="comment">// we work the Nx(2N) matrix from bottom to top and transform the left side into a unit matrix</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="comment">//   - the last row is left unchanged</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <span class="comment">//   - the last row is subtracted from every row i above, scaled by m[i,N]/m[N,N]</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    <span class="comment">// then we repeat this for the (N-1)*(N-1) left upper matrix, which has again full triangular form</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=N-1; k&gt;0; k--) {</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>        <span class="comment">//std::cout&lt;&lt;&quot;\nstep J&quot;&lt;&lt;k&lt;&lt;&quot;:\n&quot;;</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=k-1; i&gt;=0; i--) {</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>            <span class="keyword">const</span> T s=m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(i,k,C)]/m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,k,C)];</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=k; c&lt;C; c++) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>                m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(i,c,C)] -= m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c,C)]*s;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>            }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        }</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        <span class="comment">//linalgPrintMatrix(m, N, C);</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    <span class="comment">// finally each line is normalized to 1 by dividing by the diagonal entry in the left NxN matrix</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    <span class="comment">// and copy the result to matrix_out</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;N; k++) {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>        <span class="keyword">const</span> T s=m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,k,C)];</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=N; c&lt;C; c++) {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c,C)] = m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c,C)] / s;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        }</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,k,C)]=T(1);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    }</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>}</div>
</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span> </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span> </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span><span class="comment"></span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="comment">/*! \brief invert the given NxN matrix using Gauss-Jordan elimination</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span><span class="comment"></span> </div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span><span class="comment">    \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span><span class="comment">    \param matrix the matrix to invert</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span><span class="comment">    \param[out] matrix_out target for the inverted matrix</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span><span class="comment">    \param N number of rows and columns in the matrix</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span><span class="comment"></span> </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span><span class="comment">    \return \c true on success and the inverted matrix in matrix_out.</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span><span class="comment"></span> </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span><span class="comment">    \note It is save to call \c jkqtpstatMatrixInversion(A,A,N) with the same argument for in and out matrix. Then the input will be overwritten with the new matrix!</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span><span class="comment">    \note matrix and matrix_out have to be of size N*N. Matrices are interpreted as row-major!</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span><span class="comment"></span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span><span class="comment">    \see http://www.virtual-maxim.de/matrix-invertieren-in-c-plus-plus/</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span><span class="comment">*/</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00536" data-start="{" data-end="}">
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga6008a49627493cfcfb21a4124c0c495b">  536</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga6008a49627493cfcfb21a4124c0c495b">jkqtplinalgMatrixInversion</a>(<span class="keyword">const</span> T* matrix, T* matrix_out, <span class="keywordtype">long</span> N) {</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span><span class="preprocessor">#ifdef JKQTP_STATISTICS_TOOLS_MAY_USE_EIGEN3</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    <span class="keywordflow">if</span> (N==2) {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,2,2,Eigen::RowMajor&gt; &gt; eA(matrix);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        Eigen::Map&lt;Eigen::Matrix&lt;T,2,2,Eigen::RowMajor&gt; &gt; eO(matrix_out);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        eO=eA.inverse();</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="comment">//std::cout&lt;&lt;&quot;\n--------------------------------------\n2x2 input matrix\n&quot;&lt;&lt;eA&lt;&lt;&quot;\n--------------------------------------\n&quot;;</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        <span class="keywordflow">return</span> eO.allFinite();</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N==3) {</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,3,3,Eigen::RowMajor&gt; &gt; eA(matrix);</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        Eigen::Map&lt;Eigen::Matrix&lt;T,3,3,Eigen::RowMajor&gt; &gt; eO(matrix_out);</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        <span class="comment">//std::cout&lt;&lt;&quot;\n--------------------------------------\n3x3 input matrix\n&quot;&lt;&lt;eA&lt;&lt;&quot;\n--------------------------------------\n&quot;;</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        eO=eA.inverse();</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        <span class="keywordflow">return</span> eO.allFinite();</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N==4) {</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,4,4,Eigen::RowMajor&gt; &gt; eA(matrix);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        Eigen::Map&lt;Eigen::Matrix&lt;T,4,4,Eigen::RowMajor&gt; &gt; eO(matrix_out);</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        <span class="comment">//std::cout&lt;&lt;&quot;\n--------------------------------------\n4x4 input matrix\n&quot;&lt;&lt;eA&lt;&lt;&quot;\n--------------------------------------\n&quot;;</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        eO=eA.inverse();</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        <span class="keywordflow">return</span> eO.allFinite();</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt; eA(matrix,N,N);</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>        Eigen::Map&lt;Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt; eO(matrix_out,N,N);</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        eO=eA.inverse();</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        <span class="comment">//std::cout&lt;&lt;&quot;\n--------------------------------------\nNxN input matrix\n&quot;&lt;&lt;eA&lt;&lt;&quot;\n--------------------------------------\n&quot;;</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        <span class="keywordflow">return</span> eO.allFinite();</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    <span class="comment">// first build a N*(2N) matrix of the form</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    <span class="comment">//    m11 m12 ...  | 1 0 0</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="comment">//    m21 m22 ...  | 0 1 0</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    <span class="comment">//    ... ... ...  | .....</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> msize=N*N*2;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    std::vector&lt;T&gt; m;</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    m.resize(msize);</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;msize; i++) m[i]=T(0); <span class="comment">// init with 0</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;N; l++) {</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;N; c++) { <span class="comment">// init left half with matrix</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>            m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,2*N)]=matrix[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,N)];</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        }</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        <span class="comment">// init right half with unit matrix</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,N+l,2*N)]=T(1);</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    }</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span> </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="keywordtype">bool</span> ok=<a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga38c91e3f5648e6b68fce05ddeaeba3a1">jkqtplinalgGaussJordan</a>(m.data(), N, 2*N);</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    <span class="keywordflow">if</span> (ok) {</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <span class="comment">// finally we copy the result to matrix_out</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;N; k++) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=N; c&lt;2*N; c++) {</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                matrix_out[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c-N,N)] = m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c,2*N)];</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            }</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        }</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="keywordflow">return</span> ok;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>}</div>
</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span> </div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span> </div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span><span class="comment"></span> </div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span><span class="comment">/*! \brief invert the given NxN matrix using Gauss-Jordan elimination</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span><span class="comment"></span> </div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span><span class="comment">    \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span><span class="comment">    \param[in,out] matrix the matrix to invert (at the same time the target)</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span><span class="comment">    \param N number of rows and columns in the matrix</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span><span class="comment">*/</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00611" data-start="{" data-end="}">
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga7e7bc5b270ca97a55d0c755caadb5cc1">  611</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga6008a49627493cfcfb21a4124c0c495b">jkqtplinalgMatrixInversion</a>(T* matrix, <span class="keywordtype">long</span> N) {</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga6008a49627493cfcfb21a4124c0c495b">jkqtplinalgMatrixInversion</a>(matrix, matrix, N);</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>}</div>
</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> </div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="comment"></span> </div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span><span class="comment">/*! \brief solve a system of N linear equations \f$ A\cdot\vec{x}=B \f$ simultaneously for C columns in B</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span><span class="comment"></span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span><span class="comment">    \param A an NxN matrix of coefficients</span></div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span><span class="comment">    \param B an NxC marix</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span><span class="comment">    \param N number of equations</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span><span class="comment">    \param C number of columns in B</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span><span class="comment">    \param result_out a NxC matrix with the results after the inversion of the system of equations</span></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span><span class="comment">    \return \c true on success</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span><span class="comment"></span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span><span class="comment">    \note This function uses the Gauss-Jordan algorithm</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span><span class="comment">    \note It is save to call \c jkqtpstatLinSolve(A,B,N,C,B) with the same argument for B and result_out. Then the input will be overwritten with the new matrix!</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span><span class="comment">*/</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00631" data-start="{" data-end="}">
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">  631</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a>(<span class="keyword">const</span> T* A, <span class="keyword">const</span> T* B, <span class="keywordtype">long</span> N, <span class="keywordtype">long</span> C, T* result_out) {</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span><span class="preprocessor">#if defined(JKQTP_STATISTICS_TOOLS_MAY_USE_EIGEN3) &amp;&amp; (!defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_noeigen))</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <span class="keywordflow">if</span> (N==2 &amp;&amp; C==1) {</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,2,2,Eigen::RowMajor&gt; &gt; eA(A);</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        Eigen::Matrix&lt;T,2,1&gt;  eB;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        Eigen::Map&lt;Eigen::Matrix&lt;T,2,1&gt; &gt; x(result_out);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        eB=Eigen::Map&lt;const Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt;(B,2,1);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span><span class="preprocessor">#  ifdef STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_fullPivLu</span></div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        x=eA.fullPivLu().solve(eB);</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_householderQr)</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        x=eA.householderQr().solve(eB);</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_fullPivHouseholderQr)</span></div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>        x=eA.fullPivHouseholderQr().solve(eB);</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_jacobiSvd)</span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        x=eA.jacobiSVD().solve(eB);</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_colPivHouseholderQr)</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        x=eA.colPivHouseholderQr().solve(eB);</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span><span class="preprocessor">#  else</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>        x=eA.fullPivLu().solve(eB);</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="preprocessor">#  endif</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N==3 &amp;&amp; C==1) {</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,3,3,Eigen::RowMajor&gt; &gt; eA(A);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>        Eigen::Matrix&lt;T,3,1&gt;  eB;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        Eigen::Map&lt;Eigen::Matrix&lt;T,3,1&gt; &gt; x(result_out);</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span> </div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        eB=Eigen::Map&lt;const Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt;(B,3,1);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span><span class="preprocessor">#  ifdef STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_fullPivLu</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        x=eA.fullPivLu().solve(eB);</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_householderQr)</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        x=eA.householderQr().solve(eB);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_fullPivHouseholderQr)</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>        x=eA.fullPivHouseholderQr().solve(eB);</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_jacobiSvd)</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        x=eA.jacobiSVD().solve(eB);</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_colPivHouseholderQr)</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>        x=eA.colPivHouseholderQr().solve(eB);</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span><span class="preprocessor">#  else</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>        x=eA.fullPivLu().solve(eB);</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="preprocessor">#  endif</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt; eA(A,N,N);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt;  eB(N,C);</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        Eigen::Map&lt;Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt; x(result_out,N,C);</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        eB=Eigen::Map&lt;const Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt;(B,N,C);</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span><span class="preprocessor">#  ifdef STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_fullPivLu</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        x=eA.fullPivLu().solve(eB);</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_householderQr)</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>        x=eA.householderQr().solve(eB);</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_fullPivHouseholderQr)</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        x=eA.fullPivHouseholderQr().solve(eB);</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_jacobiSvd)</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        x=eA.jacobiSVD().solve(eB);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="preprocessor">#  elif defined(STATISTICS_TOOLS_linalgLinSolve_EIGENMETHOD_colPivHouseholderQr)</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>        x=eA.colPivHouseholderQr().solve(eB);</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span><span class="preprocessor">#  else</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        x=eA.fullPivLu().solve(eB);</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span><span class="preprocessor">#  endif</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    }</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <span class="comment">// first build a N*(N+C) matrix of the form</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <span class="comment">//    &lt;---- N ----&gt; &lt;---- C ----&gt;</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <span class="comment">//  ^ A11 A12 ...  | B11 B12 ...</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <span class="comment">//  | A21 A22 ...  | B21 B22 ...</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>    <span class="comment">//  N ... ... ...  | .....</span></div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    <span class="comment">//  | ... ... ...  | .....</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="comment">//  v ... ... ...  | .....</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> msize=N*(N+C);</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>    <a class="code hl_class" href="class_j_k_q_t_p_array_scoped_pointer.html">JKQTPArrayScopedPointer&lt;T&gt;</a> m(<span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(malloc(msize*<span class="keyword">sizeof</span>(T)))); <span class="comment">// use scoped pointer to ensure, that m is free&#39;d, when the function is ending</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> l=0; l&lt;N; l++) {</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;N; c++) { <span class="comment">// init left half with matrix A</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>            m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,N+C)]=A[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,N)];</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>        }</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>        <span class="comment">// init right half with B</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=0; c&lt;C; c++) { <span class="comment">// init left half with matrix B</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>            m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,N+c,N+C)]=B[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(l,c,C)];</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        }</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    }</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span> </div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span> </div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    <span class="keywordtype">bool</span> ok=<a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga38c91e3f5648e6b68fce05ddeaeba3a1">jkqtplinalgGaussJordan</a>(m.data(), N, N+C);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    <span class="keywordflow">if</span> (ok) {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;N; k++) {</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>            <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=N; c&lt;(N+C); c++) {</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a>(m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c,N+C)])) {</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>                    ok=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                }</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>            }</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            <span class="keywordflow">if</span> (!ok) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        }</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        <span class="keywordflow">if</span> (ok) {</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>            <span class="comment">// finally we copy the result to matrix_out</span></div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>            <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;N; k++) {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>                <span class="keywordflow">for</span> (<span class="keywordtype">long</span> c=N; c&lt;(N+C); c++) {</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>                    result_out[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c-N,C)] = m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(k,c,N+C)];</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>                }</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>            }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>        }</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    }</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    <span class="keywordflow">return</span> ok;</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>}</div>
</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span><span class="comment"></span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="comment">/*! \brief solve a system of N linear equations \f$ A\cdot\vec{x}=B \f$ simultaneously for C columns in B</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span><span class="comment"></span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><span class="comment">    \param A an NxN matrix of coefficients</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="comment">    \param[in,out] B an NxC marix (also receives the result)</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><span class="comment">    \param N number of equations</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span><span class="comment">    \param C number of columns in B</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span><span class="comment">    \return \c true on success</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span><span class="comment"></span> </div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span><span class="comment">    \note This function uses the Gauss-Jordan algorithm</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span><span class="comment">    \note It is save to call \c jkqtpstatLinSolve(A,B,N,C,B) with the same argument for B and result_out. Then the input will be overwritten with the new matrix!</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span><span class="comment">*/</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00756" data-start="{" data-end="}">
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga59e66bc1366f565e5b20d9cbdaa30b6d">  756</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a>(<span class="keyword">const</span> T* A, T* B, <span class="keywordtype">long</span> N, <span class="keywordtype">long</span> C) {</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a>(A,B,N,C,B);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>}</div>
</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span> </div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span><span class="comment"></span> </div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span><span class="comment">/*! \brief solve a system of N linear equations \f$ A\cdot\vec{x}=\vec{b} \f$</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span><span class="comment"></span> </div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span><span class="comment">    \param A an NxN matrix of coefficients</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span><span class="comment">    \param b an N-entry vector</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span><span class="comment">    \param N number of rows and columns in \a A</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span><span class="comment">    \param[out] result_out a N-entry vector with the result</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span><span class="comment">    \return \c true on success</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span><span class="comment"></span> </div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span><span class="comment">    \note This function uses the Gauss-Jordan algorithm</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span><span class="comment">    \note It is save to call \c jkqtpstatLinSolve(A,B,N,C,B) with the same argument for B and result_out. Then the input will be overwritten with the new matrix!</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="comment">*/</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00774" data-start="{" data-end="}">
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#gad5c740ff7f63ca0e781a5a52c491bae9">  774</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a>(<span class="keyword">const</span> T* A, <span class="keyword">const</span> T* b, <span class="keywordtype">long</span> N, T* result_out) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a>(A, b, N, 1, result_out);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>}</div>
</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span><span class="comment"></span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span><span class="comment">/*! \brief solve a system of N linear equations \f$ A\cdot\vec{x}=\vec{b} \f$</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span><span class="comment"></span> </div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span><span class="comment">    \param A an NxN matrix of coefficients</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span><span class="comment">    \param[in,out] b an N-entry vector (also receives the result)</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span><span class="comment">    \param N number of rows and columns in \a A</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span><span class="comment">    \return \c true on success</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="comment"></span> </div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span><span class="comment">    \note This function uses the Gauss-Jordan algorithm</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span><span class="comment">    \note It is save to call \c jkqtpstatLinSolve(A,B,N,C,B) with the same argument for B and result_out. Then the input will be overwritten with the new matrix!</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span><span class="comment">*/</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00790" data-start="{" data-end="}">
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga79a76a555138167366b4618ef9b02cde">  790</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a>(<span class="keyword">const</span> T* A, T* b, <span class="keywordtype">long</span> N) {</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a>(A,b,N,1,b);</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>}</div>
</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> </div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span><span class="comment"></span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span><span class="comment">/*! \brief determinant the given NxN matrix</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span><span class="comment">    \ingroup jkqtptools_math_linalg</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span><span class="comment"></span> </div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span><span class="comment">    \tparam T of the matrix cells (typically double or float)</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span><span class="comment">    \param a the matrix  for which to calculate the determinant</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span><span class="comment">    \param N number of rows and columns in the matrix</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span><span class="comment">    \return the determinant of \a a</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span><span class="comment"></span> </div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span><span class="comment">    \note for large matrices this algorithm is very slow, think about defining the macro JKQTP_STATISTICS_TOOLS_MAY_USE_EIGEN3 to use faster methods from the EIGEN library!</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span><span class="comment">*/</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="foldopen" id="foldopen00808" data-start="{" data-end="}">
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno"><a class="line" href="group__jkqtptools__math__linalg.html#ga153118402267176871c733074893a325">  808</a></span><span class="keyword">inline</span> T <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga153118402267176871c733074893a325">jkqtplinalgMatrixDeterminant</a>(<span class="keyword">const</span> T* a, <span class="keywordtype">long</span> N) {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span><span class="preprocessor">#ifdef JKQTP_STATISTICS_TOOLS_MAY_USE_EIGEN3</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    <span class="keywordflow">if</span> (N &lt; 1) { <span class="comment">/* Error */</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>        <span class="keywordflow">return</span> NAN;</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 1) { <span class="comment">/* Shouldn&#39;t get used */</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>        <span class="keywordflow">return</span> a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(0,0,N)];</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 2) {</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        <span class="keywordflow">return</span> a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(0,0,N)] * a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(1,1,N)] - a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(1,0,N)] * a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(0,1,N)];</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N==3){</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,3,3,Eigen::RowMajor&gt; &gt; eA(a);</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>        <span class="keywordflow">return</span> eA.determinant();</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N==4){</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,4,4,Eigen::RowMajor&gt; &gt; eA(a);</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>        <span class="keywordflow">return</span> eA.determinant();</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>        Eigen::Map&lt;const Eigen::Matrix&lt;T,Eigen::Dynamic,Eigen::Dynamic,Eigen::RowMajor&gt; &gt; eA(a,N,N);</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>        <span class="keywordflow">return</span> eA.determinant();</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>    }</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    <span class="keywordtype">long</span> i,j,j1,j2;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    T det = 0;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span> </div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    <span class="keywordflow">if</span> (N &lt; 1) { <span class="comment">/* Error */</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>        det=NAN;</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 1) { <span class="comment">/* Shouldn&#39;t get used */</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>        det = a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(0,0,N)];</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 2) {</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        det = a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(0,0,N)] * a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(1,1,N)] - a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(1,0,N)] * a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(0,1,N)];</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>        det = 0;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        <span class="keywordflow">for</span> (j1=0;j1&lt;N;j1++) {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>            <a class="code hl_class" href="class_j_k_q_t_p_array_scoped_pointer.html">JKQTPArrayScopedPointer&lt;T&gt;</a> m(<span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(calloc((N-1)*(N-1),<span class="keyword">sizeof</span>(T *))));</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span> </div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>            <span class="keywordflow">for</span> (i=1;i&lt;N;i++) {</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>                j2 = 0;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>                <span class="keywordflow">for</span> (j=0;j&lt;N;j++) {</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>                    <span class="keywordflow">if</span> (j != j1){</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>                        m[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(i-1,j2,N-1)] = a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(i,j,N)];</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>                        j2++;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>                    }</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>                }</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            }</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>            <span class="comment">//printf(&quot;%d: %lf (%lf  %lf)\n&quot;,j1,pow(-1.0,1.0+double(j1)+1.0),a[jkqtplinalgMatIndex(0,j1,N)], jkqtplinalgMatrixDeterminant(m,N-1));</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>            det = det + double(((1+j1+1)%2==0)?1.0:-1.0)<span class="comment">/* pow(-1.0,1.0+double(j1)+1.0)*/</span> * a[<a class="code hl_define" href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a>(0,j1,N)] * <a class="code hl_function" href="group__jkqtptools__math__linalg.html#ga153118402267176871c733074893a325">jkqtplinalgMatrixDeterminant</a>(m,N-1);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span> </div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>        }</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    }</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span> </div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    <span class="comment">//printf(&quot;\n\n  jkqtplinalgMatrixDeterminant(%d):\n&quot;,N);</span></div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    <span class="comment">//linalgPrintMatrix(a,N,N);</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>    <span class="comment">//printf(&quot;  jkqtplinalgMatrixDeterminant(%d) = %lf\n&quot;, N, det);</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    <span class="keywordflow">return</span>(det);</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>}</div>
</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span> </div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span> </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span> </div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span><span class="preprocessor">#endif </span><span class="comment">// JKQTPLINALGTOOLS_H_INCLUDED</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span> </div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span> </div>
<div class="ttc" id="aclass_j_k_q_t_p_array_scoped_pointer_html"><div class="ttname"><a href="class_j_k_q_t_p_array_scoped_pointer.html">JKQTPArrayScopedPointer</a></div><div class="ttdoc">this class ensures that the given pointer is freed when the class is destroyed.</div><div class="ttdef"><b>Definition</b> jkqtparraytools.h:108</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_array_scoped_pointer_html_ad87fcbc397ab2f51b17fc6db49aacf31"><div class="ttname"><a href="class_j_k_q_t_p_array_scoped_pointer.html#ad87fcbc397ab2f51b17fc6db49aacf31">JKQTPArrayScopedPointer::data</a></div><div class="ttdeci">T * data() const</div><div class="ttdef"><b>Definition</b> jkqtparraytools.h:138</div></div>
<div class="ttc" id="agroup__jkqtptools__math__array_html_ga3e8ffdc0989b2c229973cab00543825d"><div class="ttname"><a href="group__jkqtptools__math__array.html#ga3e8ffdc0989b2c229973cab00543825d">jkqtpArraySwap</a></div><div class="ttdeci">void jkqtpArraySwap(T *a, long long l, long long r)</div><div class="ttdoc">swap two elements l and r in an array a</div><div class="ttdef"><b>Definition</b> jkqtparraytools.h:67</div></div>
<div class="ttc" id="agroup__jkqtptools__math__array_html_ga3ee1bf982092f55f4e1d1f684aa20ea5"><div class="ttname"><a href="group__jkqtptools__math__array.html#ga3ee1bf982092f55f4e1d1f684aa20ea5">jkqtpArrayDuplicate</a></div><div class="ttdeci">T * jkqtpArrayDuplicate(const T *dataIn, long long N)</div><div class="ttdoc">duplicate an array of data</div><div class="ttdef"><b>Definition</b> jkqtparraytools.h:92</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_ga966c1a713f60bd026db4f35f7007eb7e"><div class="ttname"><a href="group__jkqtptools__math__basic.html#ga966c1a713f60bd026db4f35f7007eb7e">jkqtp_todouble</a></div><div class="ttdeci">constexpr double jkqtp_todouble(const T &amp;d)</div><div class="ttdoc">converts a boolean to a double, is used to convert boolean to double by JKQTPDatastore</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:113</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gaba414891ee7a449b462aaaff0a35635f"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gaba414891ee7a449b462aaaff0a35635f">jkqtp_boundedRoundTo</a></div><div class="ttdeci">T jkqtp_boundedRoundTo(T min, const double &amp;v, T max)</div><div class="ttdoc">round a double v using round() and convert it to a specified type T (static_cast!)....</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:237</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gaf0ace9f4ac87719798dea6ef64068ff4"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gaf0ace9f4ac87719798dea6ef64068ff4">JKQTPIsOKFloat</a></div><div class="ttdeci">bool JKQTPIsOKFloat(T v)</div><div class="ttdoc">check whether the dlotaing point number is OK (i.e. non-inf, non-NAN)</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:496</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga153118402267176871c733074893a325"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga153118402267176871c733074893a325">jkqtplinalgMatrixDeterminant</a></div><div class="ttdeci">T jkqtplinalgMatrixDeterminant(const T *a, long N)</div><div class="ttdoc">determinant the given NxN matrix</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:808</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga34eac1e10f82c5d67a055a795a51bbed"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga34eac1e10f82c5d67a055a795a51bbed">jkqtplinalgMatIndex</a></div><div class="ttdeci">#define jkqtplinalgMatIndex(l, c, C)</div><div class="ttdoc">calculate the index of the entry in line l and column c in a row-major matrix with C columns</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:79</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga36e5b138c96b8ae51452dc364c54dd0e"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga36e5b138c96b8ae51452dc364c54dd0e">jkqtplinalgTransposeMatrix</a></div><div class="ttdeci">void jkqtplinalgTransposeMatrix(T *matrix, long N)</div><div class="ttdoc">transpose the given NxN matrix</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:319</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga38c91e3f5648e6b68fce05ddeaeba3a1"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga38c91e3f5648e6b68fce05ddeaeba3a1">jkqtplinalgGaussJordan</a></div><div class="ttdeci">bool jkqtplinalgGaussJordan(T *m, long L, long C)</div><div class="ttdoc">performs a Gauss-Jordan eliminaion on a LxC matrix m</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:435</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga3e196152acbf4f8dfe3c33abb0af62a7"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga3e196152acbf4f8dfe3c33abb0af62a7">jkqtplinalgMatrixToString</a></div><div class="ttdeci">std::string jkqtplinalgMatrixToString(T *matrix, long L, long C, int width=9, int precision=3, const std::string &amp;mode=std::string(&quot;g&quot;))</div><div class="ttdoc">convert the given LxC matrix to std::string</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:121</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga4e462736a9bb361592fcb3c0832bfa0e"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga4e462736a9bb361592fcb3c0832bfa0e">jkqtplinalgMatrixToHTMLString</a></div><div class="ttdeci">std::string jkqtplinalgMatrixToHTMLString(T *matrix, long L, long C, int width=9, int precision=3, const std::string &amp;mode=std::string(&quot;g&quot;), const std::string &amp;tableformat=std::string(), const std::string &amp;prenumber=std::string(), const std::string &amp;postnumber=std::string(), bool colorcoding=false, bool zeroIsWhite=true, std::string *colorlabel=nullptr, bool nonlinColors=false, double nonlinColorsGamma=0.25, const std::string &amp;colortableformat=std::string())</div><div class="ttdoc">convert the given LxC matrix to std::string, encoded as HTML table</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:211</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga6008a49627493cfcfb21a4124c0c495b"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga6008a49627493cfcfb21a4124c0c495b">jkqtplinalgMatrixInversion</a></div><div class="ttdeci">bool jkqtplinalgMatrixInversion(const T *matrix, T *matrix_out, long N)</div><div class="ttdoc">invert the given NxN matrix using Gauss-Jordan elimination</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:536</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga68f4af6bad95143a744a1cd99a3ffeec"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga68f4af6bad95143a744a1cd99a3ffeec">jkqtplinalgPrintMatrix</a></div><div class="ttdeci">void jkqtplinalgPrintMatrix(const T *matrix, long L, long C, int width=9, int precision=3, char mode=&#39;f&#39;)</div><div class="ttdoc">print the given LxC matrix to std::cout</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:94</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga872ca35efd41f7c01c4594cbf940a7fd"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga872ca35efd41f7c01c4594cbf940a7fd">jkqtplinalgLinSolve</a></div><div class="ttdeci">bool jkqtplinalgLinSolve(const T *A, const T *B, long N, long C, T *result_out)</div><div class="ttdoc">solve a system of N linear equations  simultaneously for C columns in B</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:631</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_ga9ad3ab299feb81e4ee9ff797dbab8610"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#ga9ad3ab299feb81e4ee9ff797dbab8610">jkqtplinalgPM1ToRWBColors</a></div><div class="ttdeci">void jkqtplinalgPM1ToRWBColors(double val, uint8_t &amp;r, uint8_t &amp;g, uint8_t &amp;b)</div><div class="ttdoc">maps the number range -1 ... +1 to a color-scale lightblue - white - lightred (used for coloring matr...</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:149</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_gab16a96fa78356ea18584a53a4fe5a9d9"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#gab16a96fa78356ea18584a53a4fe5a9d9">jkqtplinalgMatrixProduct</a></div><div class="ttdeci">void jkqtplinalgMatrixProduct(const T *M1, long L1, long C1, const T *M2, long L2, long C2, T *M)</div><div class="ttdoc">matrix-matrix product</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:378</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_gab2a17f4ddff10bdef87b625278238ac2"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#gab2a17f4ddff10bdef87b625278238ac2">jkqtplinalgMatrixSwapLines</a></div><div class="ttdeci">void jkqtplinalgMatrixSwapLines(T *m, long l1, long l2, long C)</div><div class="ttdoc">swap two lines in a matrix</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:358</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_gad513c7870f8d9c7ea57fab1588a1ecab"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#gad513c7870f8d9c7ea57fab1588a1ecab">jkqtplinalgDotProduct</a></div><div class="ttdeci">T jkqtplinalgDotProduct(const T *vec1, const T *vec2, long N)</div><div class="ttdoc">dot-product between two vectors vec1 and vec2, each with a length of N entries</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:301</div></div>
<div class="ttc" id="agroup__jkqtptools__math__linalg_html_gaf33e8d679515276ac8cf2863ee9f4844"><div class="ttname"><a href="group__jkqtptools__math__linalg.html#gaf33e8d679515276ac8cf2863ee9f4844">jkqtplinalgPM1ToNonlinRWBColors</a></div><div class="ttdeci">void jkqtplinalgPM1ToNonlinRWBColors(double val, uint8_t &amp;r, uint8_t &amp;g, uint8_t &amp;b, double gamma=0.5)</div><div class="ttdoc">maps the number range -1 ... +1 to a non-linear color-scale lightblue - white - lightred (used for co...</div><div class="ttdef"><b>Definition</b> jkqtplinalgtools.h:180</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__basic_html_ga88686b7d786896c704659dc8fe4c1e7f"><div class="ttname"><a href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a></div><div class="ttdeci">void jkqtpstatMinMax(InputIt first, InputIt last, double &amp;min, double &amp;max, InputIt *minPos=nullptr, InputIt *maxPos=nullptr, size_t *Noutput=nullptr)</div><div class="ttdoc">calculates the minimum and maximum values in the given data range first ... last</div><div class="ttdef"><b>Definition</b> jkqtpstatbasics.h:168</div></div>
<div class="ttc" id="agroup__jkqtptools__string_html_ga25069128d19d112ba61d6fad739f6379"><div class="ttname"><a href="group__jkqtptools__string.html#ga25069128d19d112ba61d6fad739f6379">jkqtp_inttostr</a></div><div class="ttdeci">JKQTCOMMON_LIB_EXPORT std::string jkqtp_inttostr(long data)</div><div class="ttdoc">convert an integer to a string</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a href="dir_41b64d01ba73fd10a3db4d8d86d562c2.html">jkqtmath</a></li><li class="navelem"><b>jkqtplinalgtools.h</b></li>
    <li class="footer">Generated on <span class="timestamp"></span> for JKQTPlotter by <a href="https://www.doxygen.org/index.html">doxygen</a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
