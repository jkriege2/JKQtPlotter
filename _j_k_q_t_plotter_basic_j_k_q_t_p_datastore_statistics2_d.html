<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JKQTPlotter: Tutorial (JKQTPDatastore): Advanced 2-Dimensional Statistics with JKQTPDatastore</title>
<meta name="description" content="an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies">
<meta name="keywords" lang="en-us" content="C++, C++11, Qt, Qt5, Qt6, Plotting, Plot, Chart, Graph, Qt, Widget, C++, Library, Visualization, charting library, plotting library, scientific visualization, data visualization, statistics, statistical methods, statistics library, LaTeX parser, LaTeX renderer, Qt widget, Qt5 widget, Qt6 widget, Qt charts, Qt plots, barchart, violinplot, boxplot, JKQtPlotter, JKQTMathText, JKQTFastPlotter">
<meta name="author" content="$author">
<meta name="copyright" content="(c) 2008-2022 by $author">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="jkqtplotter_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_doxygen.png"/></td>
  <td id="projectalign">
   <div id="projectname">JKQTPlotter<span id="projectnumber">&#160;trunk/v5.0.0</span>
   </div>
   <div id="projectbrief">an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<div id="main-nav">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- main-nav -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics2_d.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Tutorial (JKQTPDatastore): Advanced 2-Dimensional Statistics with JKQTPDatastore </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_examples_2datastore__statistics__2d_2_r_e_a_d_m_e"></a></p>
<p>This tutorial project (see <span class="tt">./examples/datastore_statistics_2d/</span>) explains several advanced functions of <a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a> in combination with the [<a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a>] conatined in <a class="el" href="class_j_k_q_t_plotter.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)">JKQTPlotter</a>.</p>
<p><em><b>Note</b></em> that there are additional tutorial explaining other aspects of data mangement in <a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a>:</p><ul>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore.html">Basic Usage of JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_iterators.html">Iterator-Based usage of JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics.html">Advanced 1-Dimensional Statistics with JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_regression.html">Regression Analysis (with the Statistics Library)</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics_grouped_stat.html">1-Dimensional Group Statistics with JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics2_d.html">Advanced 2-Dimensional Statistics with JKQTPDatastore</a></li>
</ul>
<p>The source code of the main application can be found in <a href="https://github.com/jkriege2/JKQtPlotter/tree/master/examples/datastore_statistics_2d/datastore_statistics_2d.cpp"><span class="tt">datastore_statistics_2d.cpp</span></a>. This tutorial cites only parts of this code to demonstrate different ways of working with data for the graphs.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md57"></a>
Generating different sets of random numbers</h1>
<p>The code segments below will fill different instances of <a class="el" href="class_j_k_q_t_plotter.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)">JKQTPlotter</a> with different statistical plots. All these plots are based on either of two sets of random number pairs (i.e. x/y-locations) generated as shown here: </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> randomdatacolx_small=datastore1-&gt;addColumn(<span class="stringliteral">&quot;random data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> randomdatacoly_small=datastore1-&gt;addColumn(<span class="stringliteral">&quot;random data, y&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> randomdatacoldist_small=datastore1-&gt;addColumn(<span class="stringliteral">&quot;random data, distribution/class&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> randomdatacolx=datastore1-&gt;addColumn(<span class="stringliteral">&quot;random data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> randomdatacoly=datastore1-&gt;addColumn(<span class="stringliteral">&quot;random data, y&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> randomdatacoldist=datastore1-&gt;addColumn(<span class="stringliteral">&quot;random data, distribution/class&quot;</span>);</div>
<div class="line"><span class="comment">// random number generators:</span></div>
<div class="line">std::random_device rd;</div>
<div class="line">std::mt19937 gen{rd()};</div>
<div class="line">std::uniform_int_distribution&lt;&gt; ddecide(0,2);</div>
<div class="line">std::normal_distribution&lt;&gt; d1x{5,3};</div>
<div class="line">std::normal_distribution&lt;&gt; d1y{5,1};</div>
<div class="line">std::normal_distribution&lt;&gt; d2x{10,2};</div>
<div class="line">std::normal_distribution&lt;&gt; d2y{10,5};</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;500; i++) {</div>
<div class="line">    <span class="keywordtype">double</span> rx=0,ry=0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> decide=ddecide(gen);</div>
<div class="line">    <span class="keywordflow">if</span> (decide==0) {</div>
<div class="line">        rx=d1x(gen);</div>
<div class="line">        ry=d1y(gen);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        rx=d2x(gen);</div>
<div class="line">        ry=d2y(gen);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (i&lt;150) {</div>
<div class="line">        datastore1-&gt;appendToColumn(randomdatacolx_small, rx);</div>
<div class="line">        datastore1-&gt;appendToColumn(randomdatacoly_small, ry);</div>
<div class="line">        datastore1-&gt;appendToColumn(randomdatacoldist_small, std::min(1,decide));</div>
<div class="line">    }</div>
<div class="line">    datastore1-&gt;appendToColumn(randomdatacolx, rx);</div>
<div class="line">    datastore1-&gt;appendToColumn(randomdatacoly, ry);</div>
<div class="line">    datastore1-&gt;appendToColumn(randomdatacoldist, std::min(1,decide));</div>
<div class="line">}</div>
</div><!-- fragment --><p>The columns <span class="tt">randomdatacolx</span> and <span class="tt">randomdatacoly</span> will contain 500 random numbers. Each one is drawn either from the normal distributions <span class="tt">d1x</span>/<span class="tt">d1y</span>, or <span class="tt">d2x</span>/<span class="tt">d2y</span>. The decision, which of the two to use is based on the result of a third random distribution <span class="tt">ddecide</span>, which only returns 0, 1 or 2 (<span class="tt">d1x</span>/<span class="tt">d1y</span> is chosen for <span class="tt">ddecide==0</span>). The column <span class="tt">randomdatacoldist</span> finally encodes which pair of distributions was chosen. The three columns <span class="tt">randomdatacolx_small</span>, <span class="tt">randomdatacoly_small</span> and <span class="tt">randomdatacoldist_small</span> represent a subset of the first 150 numbers from the full dataset. The columns are generated empty by calling <span class="tt"><a class="el" href="class_j_k_q_t_p_datastore.html#ae057eda96c7b754cd42f4380b429a589" title="add a new column to the datastore and return its ID">JKQTPDatastore::addColumn()</a></span> with only a name. Then the actual values are added by calling <span class="tt"><a class="el" href="class_j_k_q_t_p_datastore.html#a3a992ac63957ce0c521e48944f704d91" title="adds a value value to the column column. This changes the column length (number of rows).">JKQTPDatastore::appendToColumn()</a></span>.</p>
<p>The datasets generated above can be plotted using a simple scatterplot (here shown for the full dataset only): </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html">JKQTPXYParametrizedScatterGraph</a>* gDataHist;</div>
<div class="line">plothist-&gt;addGraph(gDataHist=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html">JKQTPXYParametrizedScatterGraph</a>(plothist));</div>
<div class="line">gDataHist-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">setXYColumns</a>(randomdatacolx,randomdatacoly);</div>
<div class="line">gDataHist-&gt;<a class="code hl_function" href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html#a59ab512d8b152551916f199ee7c008eb">setSymbolColumn</a>(randomdatacoldist);</div>
<div class="line">QMap&lt;double, JKQTPGraphSymbols&gt; mapped;</div>
<div class="line">mapped[0]=<a class="code hl_enumvalue" href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5ba7d1d103c92b5fb6152ddf135315f3449">JKQTPGraphSymbols::JKQTPCross</a>;</div>
<div class="line">mapped[1]=<a class="code hl_enumvalue" href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5badd74965fc1b02e29ba1d9b34a99ffc9b">JKQTPGraphSymbols::JKQTPPlus</a>;</div>
<div class="line">gDataHist-&gt;<a class="code hl_function" href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html#af171757d60d83ebb7bb5890207591901">setMappedSymbolColumnFunctor</a>(mapped);</div>
<div class="line">gDataHist-&gt;<a class="code hl_function" href="class_j_k_q_t_p_graph_symbol_style_mixin.html#a7b5bdf1d3b33bcdc2ec82026e6fd55b9">setSymbolSize</a>(5);</div>
<div class="line">gDataHist-&gt;<a class="code hl_function" href="class_j_k_q_t_p_graph_symbol_style_mixin.html#a9622acb8fb77c6915877acc6990c31bb">setSymbolColor</a>(<a class="code hl_function" href="group__jkqtpplotter__styling__classes.html#ga4840ec94f56ddc9df4bf5d2c3d0c15ae">QColorWithAlphaF</a>(QColor(<span class="stringliteral">&quot;red&quot;</span>), 0.7));</div>
<div class="line">gDataHist-&gt;<a class="code hl_function" href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html#a2e4da542e348ad0d6353fa91b3859516">setDrawLine</a>(<span class="keyword">false</span>);</div>
<div class="line">gDataHist-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;random data, $N=&quot;</span>+QString::number(datastore1-&gt;getRows(randomdatacoldist))+<span class="stringliteral">&quot;$&quot;</span>));</div>
<div class="ttc" id="aclass_j_k_q_t_p_graph_symbol_style_mixin_html_a7b5bdf1d3b33bcdc2ec82026e6fd55b9"><div class="ttname"><a href="class_j_k_q_t_p_graph_symbol_style_mixin.html#a7b5bdf1d3b33bcdc2ec82026e6fd55b9">JKQTPGraphSymbolStyleMixin::setSymbolSize</a></div><div class="ttdeci">void setSymbolSize(double __value)</div><div class="ttdoc">set the size (=diameter in pt) of the graph symbol (in pt)</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_graph_symbol_style_mixin_html_a9622acb8fb77c6915877acc6990c31bb"><div class="ttname"><a href="class_j_k_q_t_p_graph_symbol_style_mixin.html#a9622acb8fb77c6915877acc6990c31bb">JKQTPGraphSymbolStyleMixin::setSymbolColor</a></div><div class="ttdeci">void setSymbolColor(const QColor &amp;__value)</div><div class="ttdoc">set the color of the graph symbols</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_plot_element_html_a02a8d7c24cde7768f0134cee1aa1159d"><div class="ttname"><a href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">JKQTPPlotElement::setTitle</a></div><div class="ttdeci">virtual void setTitle(const QString &amp;__value)</div><div class="ttdoc">sets the title of the plot (for display in key!).</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_graph_html_a972ee50c53accadade8880b3bd1110cc"><div class="ttname"><a href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">JKQTPXYGraph::setXYColumns</a></div><div class="ttdeci">void setXYColumns(size_t xCol, size_t yCol)</div><div class="ttdoc">sets xColumn and yColumn at the same time</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_parametrized_scatter_graph_html"><div class="ttname"><a href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html">JKQTPXYParametrizedScatterGraph</a></div><div class="ttdoc">This implements xy scatter plots (like JKQTPXYScatterGraph), but the color and size of the symbols ma...</div><div class="ttdef"><b>Definition</b> jkqtpscatter.h:147</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_parametrized_scatter_graph_html_a2e4da542e348ad0d6353fa91b3859516"><div class="ttname"><a href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html#a2e4da542e348ad0d6353fa91b3859516">JKQTPXYParametrizedScatterGraph::setDrawLine</a></div><div class="ttdeci">void setDrawLine(bool __value)</div><div class="ttdoc">indicates whether to draw a line or not</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_parametrized_scatter_graph_html_a59ab512d8b152551916f199ee7c008eb"><div class="ttname"><a href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html#a59ab512d8b152551916f199ee7c008eb">JKQTPXYParametrizedScatterGraph::setSymbolColumn</a></div><div class="ttdeci">void setSymbolColumn(int __value)</div><div class="ttdoc">this column contains the symbol type</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_parametrized_scatter_graph_html_af171757d60d83ebb7bb5890207591901"><div class="ttname"><a href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html#af171757d60d83ebb7bb5890207591901">JKQTPXYParametrizedScatterGraph::setMappedSymbolColumnFunctor</a></div><div class="ttdeci">void setMappedSymbolColumnFunctor(const QMap&lt; double, JKQTPGraphSymbols &gt; &amp;symmap)</div><div class="ttdoc">defines a special functor, which converts a value from the symbolColumn into an actual symbol type,...</div></div>
<div class="ttc" id="agroup__jkqtpplotter__styling__classes_html_ga4840ec94f56ddc9df4bf5d2c3d0c15ae"><div class="ttname"><a href="group__jkqtpplotter__styling__classes.html#ga4840ec94f56ddc9df4bf5d2c3d0c15ae">QColorWithAlphaF</a></div><div class="ttdeci">QColor QColorWithAlphaF(const QColor &amp;color, qreal alphaF)</div><div class="ttdoc">construct a QColor, based on the given color, but with alpha set to the specified value alphaF</div><div class="ttdef"><b>Definition</b> jkqtptools.h:364</div></div>
<div class="ttc" id="agroup__jkqtptools__drawing_html_ggacdaaac6baeadbfd3677d4d53ea594b5ba7d1d103c92b5fb6152ddf135315f3449"><div class="ttname"><a href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5ba7d1d103c92b5fb6152ddf135315f3449">JKQTPCross</a></div><div class="ttdeci">@ JKQTPCross</div><div class="ttdoc">a X cross</div><div class="ttdef"><b>Definition</b> jkqtpdrawingtools.h:146</div></div>
<div class="ttc" id="agroup__jkqtptools__drawing_html_ggacdaaac6baeadbfd3677d4d53ea594b5badd74965fc1b02e29ba1d9b34a99ffc9b"><div class="ttname"><a href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5badd74965fc1b02e29ba1d9b34a99ffc9b">JKQTPPlus</a></div><div class="ttdeci">@ JKQTPPlus</div><div class="ttdoc">a + cross</div><div class="ttdef"><b>Definition</b> jkqtpdrawingtools.h:147</div></div>
</div><!-- fragment --><p>In addition to get an idea of the used distributions, we can add two ellipses indicating the (doubled) standard deviations of the two distributions:</p>
<div class="fragment"><div class="line"><span class="comment">// 2.3. to visualize the initial distributions, we draw an ellipse indicating the</span></div>
<div class="line"><span class="comment">//      variance of the distributions</span></div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>* gEll1Hist;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>* gEll2Hist;</div>
<div class="line">plothist-&gt;addGraph(gEll1Hist=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>(plothist, d1x.mean(), d1y.mean(),d1x.stddev()*2.0,d1y.stddev()*2.0));</div>
<div class="line">plothist-&gt;addGraph(gEll2Hist=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>(plothist, d2x.mean(), d2y.mean(),d2x.stddev()*2.0,d2y.stddev()*2.0));</div>
<div class="ttc" id="aclass_j_k_q_t_p_geo_ellipse_html"><div class="ttname"><a href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a></div><div class="ttdoc">This JKQTPGeometricPlotElement is used to draw an ellipse.</div><div class="ttdef"><b>Definition</b> jkqtpgeoshapes.h:300</div></div>
</div><!-- fragment --><p>The resulting plot looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_scatteronly.png" alt="datastore_statistics_2d_scatteronly" class="inline"/></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md58"></a>
Marginal Statistics</h1>
<p>To explore the statistical properties of a 2D dataset, it is often useful to draw the marginal histograms, i.e. the histograms of one of the two variables. To do so, we use the function <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga8ff37e2bd7bd79311cca2c5cc3b65345" title="calculate an autoranged histogram and add a JKQTPBarVerticalGraph to the given plotter,...">jkqtpstatAddHHistogram1DAutoranged()</a></span> and <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga4797755e8ed88b52e524f38e49fd396e" title="calculate an autoranged histogram and add a JKQTPBarHorizontalGraph to the given plotter,...">jkqtpstatAddVHistogram1DAutoranged()</a></span> that were introduced in <a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics.html">Advanced 1-Dimensional Statistics with JKQTPDatastore</a> and are explained in detail there:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga8ff37e2bd7bd79311cca2c5cc3b65345">jkqtpstatAddHHistogram1DAutoranged</a>(plothistBottom-&gt;getPlotter(),  datastore1-&gt;begin(randomdatacolx), datastore1-&gt;end(randomdatacolx), 1.0, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga4797755e8ed88b52e524f38e49fd396e">jkqtpstatAddVHistogram1DAutoranged</a>(plothistLeft-&gt;getPlotter(),  datastore1-&gt;begin(randomdatacoly), datastore1-&gt;end(randomdatacoly), 1.0, <span class="keyword">true</span>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga4797755e8ed88b52e524f38e49fd396e"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga4797755e8ed88b52e524f38e49fd396e">jkqtpstatAddVHistogram1DAutoranged</a></div><div class="ttdeci">JKQTPBarHorizontalGraph * jkqtpstatAddVHistogram1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int bins=11, bool normalized=true, bool cummulative=false, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;))</div><div class="ttdoc">calculate an autoranged histogram and add a JKQTPBarHorizontalGraph to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:941</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga8ff37e2bd7bd79311cca2c5cc3b65345"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga8ff37e2bd7bd79311cca2c5cc3b65345">jkqtpstatAddHHistogram1DAutoranged</a></div><div class="ttdeci">JKQTPBarVerticalGraph * jkqtpstatAddHHistogram1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int bins=11, bool normalized=true, bool cummulative=false, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;))</div><div class="ttdoc">calculate an autoranged histogram and add a JKQTPBarVerticalGraph to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:828</div></div>
</div><!-- fragment --><p>Note that the plots are put into <span class="tt"><a class="el" href="class_j_k_q_t_plotter.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)">JKQTPlotter</a></span>-instances <span class="tt">plothistBottom</span> and <span class="tt">plothistLeft</span>. These are put into a global <span class="tt">QGridSizer</span> just below and left of the main histogram plot <span class="tt">plothist</span>. The axes of these plots are linked to the main plot, so zooming one affects the other plot too and their axes are inverted, so the drawn histogram elongates to the left and to the bottom (starting with 0 at the main plot <span class="tt">plothist</span>):</p>
<div class="fragment"><div class="line">QGridLayout* lay;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>* plothist=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>(&amp;mainWidget);</div>
<div class="line">lay-&gt;addWidget(plothist,0,1);</div>
<div class="line">plothist-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a59f5e9add382cb1ad35ac7d17fe8d353">getPlotter</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_base_plotter.html#a51e74fc47c173ac4af813e64a5f71af8">setPlotLabel</a>(<span class="stringliteral">&quot;Histograms&quot;</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_datastore.html">JKQTPDatastore</a>* datastore1=plothist-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#ae31c276a93cbf7aa8f9c153327aa5b74">getDatastore</a>();</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>* plothistLeft=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>(datastore1, &amp;mainWidget);</div>
<div class="line">lay-&gt;addWidget(plothistLeft,0,0);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>* plothistBottom=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>(datastore1, &amp;mainWidget);</div>
<div class="line">lay-&gt;addWidget(plothistBottom,1,1);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a16ae94f2b054e92a9184474118a1c814">synchronizeYToMaster</a>(plothist);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_slot" href="class_j_k_q_t_plotter.html#a48c261d683b78d962286027fb2d258c2">setAbsoluteX</a>(0,1);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#af0b876017115828f4d14581621808323">getXAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#af7195679bcccfbea2d4155d7f48a90da">setInverted</a>(<span class="keyword">true</span>);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#af0b876017115828f4d14581621808323">getXAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#a65945c285e8cead77c39bd914ea4b857">setShowZeroAxis</a>(<span class="keyword">false</span>);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a437abd33055811932de68ad81eea897c">getYAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#a65945c285e8cead77c39bd914ea4b857">setShowZeroAxis</a>(<span class="keyword">false</span>);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a437abd33055811932de68ad81eea897c">getYAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#abbb67629ef6ef4a70127492074bb5f7b">setDrawMode1</a>(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b">JKQTPCADMLine</a>);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a437abd33055811932de68ad81eea897c">getYAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#a4ca7a81182858c3bd85dcecfff6c4ffd">setDrawMode2</a>(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1">JKQTPCADMLineTicks</a>);</div>
<div class="line">plothistLeft-&gt;<a class="code hl_slot" href="class_j_k_q_t_plotter.html#a69cfb345b5f0511cd086f6d541f454c2">setGrid</a>(<span class="keyword">false</span>);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a85735d84b5876d63cb2e1f87e7d58f16">synchronizeXToMaster</a>(plothist);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_slot" href="class_j_k_q_t_plotter.html#acde92b94d19a03cd7020a95965c339a5">setAbsoluteY</a>(0,1);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a437abd33055811932de68ad81eea897c">getYAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#af7195679bcccfbea2d4155d7f48a90da">setInverted</a>(<span class="keyword">true</span>);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#af0b876017115828f4d14581621808323">getXAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#a65945c285e8cead77c39bd914ea4b857">setShowZeroAxis</a>(<span class="keyword">false</span>);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a437abd33055811932de68ad81eea897c">getYAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#a65945c285e8cead77c39bd914ea4b857">setShowZeroAxis</a>(<span class="keyword">false</span>);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#af0b876017115828f4d14581621808323">getXAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#abbb67629ef6ef4a70127492074bb5f7b">setDrawMode1</a>(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b">JKQTPCADMLine</a>);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#af0b876017115828f4d14581621808323">getXAxis</a>()-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_coordinate_axis.html#a4ca7a81182858c3bd85dcecfff6c4ffd">setDrawMode2</a>(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1">JKQTPCADMLineTicks</a>);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_slot" href="class_j_k_q_t_plotter.html#a69cfb345b5f0511cd086f6d541f454c2">setGrid</a>(<span class="keyword">false</span>);</div>
<div class="line">plothistBottom-&gt;<a class="code hl_slot" href="class_j_k_q_t_plotter.html#a6fad14bc73e1281ec00a6987c73c9753">setMousePositionShown</a>(<span class="keyword">false</span>);</div>
<div class="ttc" id="aclass_j_k_q_t_base_plotter_html_a51e74fc47c173ac4af813e64a5f71af8"><div class="ttname"><a href="class_j_k_q_t_base_plotter.html#a51e74fc47c173ac4af813e64a5f71af8">JKQTBasePlotter::setPlotLabel</a></div><div class="ttdeci">void setPlotLabel(const QString &amp;__value)</div><div class="ttdoc">set the plot label text</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_coordinate_axis_html_a4ca7a81182858c3bd85dcecfff6c4ffd"><div class="ttname"><a href="class_j_k_q_t_p_coordinate_axis.html#a4ca7a81182858c3bd85dcecfff6c4ffd">JKQTPCoordinateAxis::setDrawMode2</a></div><div class="ttdeci">void setDrawMode2(JKQTPCADrawMode __value)</div><div class="ttdoc">draw mode of the secondary (right/top) axis</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_coordinate_axis_html_a65945c285e8cead77c39bd914ea4b857"><div class="ttname"><a href="class_j_k_q_t_p_coordinate_axis.html#a65945c285e8cead77c39bd914ea4b857">JKQTPCoordinateAxis::setShowZeroAxis</a></div><div class="ttdeci">void setShowZeroAxis(bool __value)</div><div class="ttdoc">indicates whether to draw a thick axis line at x=0 (zero axis)</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_coordinate_axis_html_abbb67629ef6ef4a70127492074bb5f7b"><div class="ttname"><a href="class_j_k_q_t_p_coordinate_axis.html#abbb67629ef6ef4a70127492074bb5f7b">JKQTPCoordinateAxis::setDrawMode1</a></div><div class="ttdeci">void setDrawMode1(JKQTPCADrawMode __value)</div><div class="ttdoc">draw mode of the main (left/bottom) axis</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_coordinate_axis_html_af7195679bcccfbea2d4155d7f48a90da"><div class="ttname"><a href="class_j_k_q_t_p_coordinate_axis.html#af7195679bcccfbea2d4155d7f48a90da">JKQTPCoordinateAxis::setInverted</a></div><div class="ttdeci">void setInverted(bool __value)</div><div class="ttdoc">indicates whether the axis is to be inverted or not</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_datastore_html"><div class="ttname"><a href="class_j_k_q_t_p_datastore.html">JKQTPDatastore</a></div><div class="ttdoc">This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...</div><div class="ttdef"><b>Definition</b> jkqtpdatastorage.h:282</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html"><div class="ttname"><a href="class_j_k_q_t_plotter.html">JKQTPlotter</a></div><div class="ttdoc">plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:374</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a16ae94f2b054e92a9184474118a1c814"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a16ae94f2b054e92a9184474118a1c814">JKQTPlotter::synchronizeYToMaster</a></div><div class="ttdeci">void synchronizeYToMaster(JKQTPlotter *master, bool synchronizeAxisLength=true, bool synchronizeZoomingMasterToSlave=true, bool synchronizeZoomingSlaveToMaster=true)</div><div class="ttdoc">synchronize the plot y-axis height (and y-zooming) with a given master plotter (master --&gt; slave/this...</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a437abd33055811932de68ad81eea897c"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a437abd33055811932de68ad81eea897c">JKQTPlotter::getYAxis</a></div><div class="ttdeci">JKQTPVerticalAxisBase * getYAxis(JKQTPCoordinateAxisRef axis=JKQTPPrimaryAxis)</div><div class="ttdoc">returns the y-axis objet of the plot</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:725</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a48c261d683b78d962286027fb2d258c2"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a48c261d683b78d962286027fb2d258c2">JKQTPlotter::setAbsoluteX</a></div><div class="ttdeci">void setAbsoluteX(double xminn, double xmaxx)</div><div class="ttdoc">sets absolutely limiting x-range of the plot</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:1164</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a59f5e9add382cb1ad35ac7d17fe8d353"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a59f5e9add382cb1ad35ac7d17fe8d353">JKQTPlotter::getPlotter</a></div><div class="ttdeci">JKQTBasePlotter * getPlotter()</div><div class="ttdoc">returns the JKQTBasePlotter object internally used for plotting</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:414</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a69cfb345b5f0511cd086f6d541f454c2"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a69cfb345b5f0511cd086f6d541f454c2">JKQTPlotter::setGrid</a></div><div class="ttdeci">void setGrid(bool val)</div><div class="ttdoc">sets whether the major grid lines of the major axes are shown</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:942</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a6fad14bc73e1281ec00a6987c73c9753"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a6fad14bc73e1281ec00a6987c73c9753">JKQTPlotter::setMousePositionShown</a></div><div class="ttdeci">void setMousePositionShown(bool __value)</div><div class="ttdoc">specifies whether to display the current position of the mouse in the top border of the plot (this ma...</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a85735d84b5876d63cb2e1f87e7d58f16"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a85735d84b5876d63cb2e1f87e7d58f16">JKQTPlotter::synchronizeXToMaster</a></div><div class="ttdeci">void synchronizeXToMaster(JKQTPlotter *master, bool synchronizeAxisLength=true, bool synchronizeZoomingMasterToSlave=true, bool synchronizeZoomingSlaveToMaster=true)</div><div class="ttdoc">synchronize the plot x-axis width (and x-zooming) with a given master plotter (master --&gt; slave/this)</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_acde92b94d19a03cd7020a95965c339a5"><div class="ttname"><a href="class_j_k_q_t_plotter.html#acde92b94d19a03cd7020a95965c339a5">JKQTPlotter::setAbsoluteY</a></div><div class="ttdeci">void setAbsoluteY(double yminn, double ymaxx)</div><div class="ttdoc">sets absolute minimum and maximum y-value to plot</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:1167</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_ae31c276a93cbf7aa8f9c153327aa5b74"><div class="ttname"><a href="class_j_k_q_t_plotter.html#ae31c276a93cbf7aa8f9c153327aa5b74">JKQTPlotter::getDatastore</a></div><div class="ttdeci">JKQTPDatastore * getDatastore()</div><div class="ttdoc">returns a pointer to the datastore used by this object</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:621</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_af0b876017115828f4d14581621808323"><div class="ttname"><a href="class_j_k_q_t_plotter.html#af0b876017115828f4d14581621808323">JKQTPlotter::getXAxis</a></div><div class="ttdeci">JKQTPHorizontalAxisBase * getXAxis(JKQTPCoordinateAxisRef axis=JKQTPPrimaryAxis)</div><div class="ttdoc">returns the x-axis objet of the plot</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:723</div></div>
<div class="ttc" id="agroup__jkqtpplottersupprt_html_gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b"><div class="ttname"><a href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b">JKQTPCADMLine</a></div><div class="ttdeci">@ JKQTPCADMLine</div><div class="ttdoc">draw axis as thick line</div><div class="ttdef"><b>Definition</b> jkqtptools.h:403</div></div>
<div class="ttc" id="agroup__jkqtpplottersupprt_html_gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1"><div class="ttname"><a href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1">JKQTPCADMLineTicks</a></div><div class="ttdeci">@ JKQTPCADMLineTicks</div><div class="ttdoc">draw axis with ticks and line</div><div class="ttdef"><b>Definition</b> jkqtptools.h:414</div></div>
</div><!-- fragment --><p>This results in a graph like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_marginhist.png" alt="datastore_statistics_2d_marginhist" class="inline"/></p>
<p>With the same method, also marginal Kernel Density Estimates can be drawn:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bwx=<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx_small));</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#gaab1d97b4953dbe7ed0f78d2b29d8f341">jkqtpstatAddHKDE1DAutoranged</a>(plotkdeBottom-&gt;getPlotter(),  datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx_small), 0.01, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a>, bwx);</div>
<div class="line"><span class="keywordtype">double</span> bwy=<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly_small));</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga4d6431fd319ea8517ee85b99fb6437cb">jkqtpstatAddVKDE1DAutoranged</a>(plotkdeRight-&gt;getPlotter(),  datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly_small), 0.01, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a>, bwy);</div>
<div class="ttc" id="aclass_j_k_q_t_p_datastore_html_a6d3927a7c56a239d283e42fb6a48d6b7"><div class="ttname"><a href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">JKQTPDatastore::begin</a></div><div class="ttdeci">ColumnIterator begin()</div><div class="ttdoc">returns an iterator to the first column in the JKQTPDatastore</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_datastore_html_ab67341aad7c2de279970b5a7b5362042"><div class="ttname"><a href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">JKQTPDatastore::end</a></div><div class="ttdeci">ColumnIterator end()</div><div class="ttdoc">returns an iterator behind the last column in the JKQTPDatastore</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gadc261fe2e23128426ab9903e26a02885"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gadc261fe2e23128426ab9903e26a02885">jkqtpstatKernel1DGaussian</a></div><div class="ttdeci">double jkqtpstatKernel1DGaussian(double t)</div><div class="ttdoc">a 1D Gaussian kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:52</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde_html_ga6f694ee485a9939331ed0ef6fe423706"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a></div><div class="ttdeci">double jkqtpstatEstimateKDEBandwidth(InputIt first, InputIt last)</div><div class="ttdoc">estimates a bandwidth for a Kernel Density Estimator (KDE) of the given data first ....</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:192</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga4d6431fd319ea8517ee85b99fb6437cb"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga4d6431fd319ea8517ee85b99fb6437cb">jkqtpstatAddVKDE1DAutoranged</a></div><div class="ttdeci">JKQTPXYLineGraph * jkqtpstatAddVKDE1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int Nout=100, const std::function&lt; double(double)&gt; &amp;kernel=std::function&lt; double(double)&gt;(&amp;jkqtpstatKernel1DGaussian), double bandwidth=1.0, bool cummulative=false, const QString &amp;KDEcolumnBaseName=QString(&quot;KDE&quot;))</div><div class="ttdoc">calculate an autoranged vertical KDE and add a JKQTPXYLineGraph to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1457</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_gaab1d97b4953dbe7ed0f78d2b29d8f341"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#gaab1d97b4953dbe7ed0f78d2b29d8f341">jkqtpstatAddHKDE1DAutoranged</a></div><div class="ttdeci">JKQTPXYLineGraph * jkqtpstatAddHKDE1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int Nout=100, const std::function&lt; double(double)&gt; &amp;kernel=std::function&lt; double(double)&gt;(&amp;jkqtpstatKernel1DGaussian), double bandwidth=1.0, bool cummulative=false, const QString &amp;KDEcolumnBaseName=QString(&quot;KDE&quot;))</div><div class="ttdoc">calculate an autoranged KDE and add a JKQTPXYLineGraph to the given plotter, where the KDE is calcula...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1279</div></div>
</div><!-- fragment --><p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_marginkde.png" alt="datastore_statistics_2d_marginkde" class="inline"/></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md59"></a>
2D Histogram</h1>
<p>Calculating 2D-Histograms is implemented in <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__2dhist.html#gad8ab0d1e867375485e2c64743e12ab44" title="calculate a 2-dimensional histogram from the given data range firstX / firstY ... lastY / lastY">jkqtpstatHistogram2D()</a></span> from the <a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a>. This functions calculates a histogram on a given grid with the first bin at <span class="tt">xmin,ymin</span> and the last bin at <span class="tt">xmax,ymax</span>, containing <span class="tt">Nx,Ny</span> bins in x-/y-direction. You can use the result to fill new image column (with <span class="tt">Nx</span> columns and <span class="tt">Ny</span> rows) in a <span class="tt"><a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a></span>, which can then be used to draw the histogram.</p>
<p>First we have to determine the x- and y-range of data and calculate the number of bins from these:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> xmin=0, xmax=0;</div>
<div class="line"><span class="keywordtype">double</span> ymin=0, ymax=0;</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx), xmin,xmax);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly), ymin,ymax);</div>
<div class="line"><span class="keywordtype">size_t</span> Nx=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga7d3fc545bf6193a1ad76bb2870327843">jkqtp_ceilTo&lt;size_t&gt;</a>((xmax-xmin)/2.0);</div>
<div class="line"><span class="keywordtype">size_t</span> Ny=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga7d3fc545bf6193a1ad76bb2870327843">jkqtp_ceilTo&lt;size_t&gt;</a>((ymax-ymin)/2.0);</div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_ga7d3fc545bf6193a1ad76bb2870327843"><div class="ttname"><a href="group__jkqtptools__math__basic.html#ga7d3fc545bf6193a1ad76bb2870327843">jkqtp_ceilTo</a></div><div class="ttdeci">T jkqtp_ceilTo(const double &amp;v)</div><div class="ttdoc">round a double v using ceil() and convert it to a specified type T (static_cast!)</div><div class="ttdef"><b>Definition</b> jkqtpmathtools.h:181</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__basic_html_ga88686b7d786896c704659dc8fe4c1e7f"><div class="ttname"><a href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a></div><div class="ttdeci">void jkqtpstatMinMax(InputIt first, InputIt last, double &amp;min, double &amp;max, InputIt *minPos=nullptr, InputIt *maxPos=nullptr, size_t *Noutput=nullptr)</div><div class="ttdoc">calculates the minimum and maximum values in the given data range first ... last</div><div class="ttdef"><b>Definition</b> jkqtpstatbasics.h:168</div></div>
</div><!-- fragment --><p>Now we can add the image column </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> histcol=datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a3ce797890c214db3794bca76ffefef8e">addImageColumn</a>(Nx, Ny, <span class="stringliteral">&quot;2d histogram&quot;</span>);</div>
<div class="ttc" id="aclass_j_k_q_t_p_datastore_html_a3ce797890c214db3794bca76ffefef8e"><div class="ttname"><a href="class_j_k_q_t_p_datastore.html#a3ce797890c214db3794bca76ffefef8e">JKQTPDatastore::addImageColumn</a></div><div class="ttdeci">size_t addImageColumn(size_t width, size_t height, const QString &amp;name=QString(&quot;&quot;))</div><div class="ttdoc">add a new columns with width * height rows to the datastore and return its column ID....</div></div>
</div><!-- fragment --><p> and calculate the histogram: </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__2dhist.html#gad8ab0d1e867375485e2c64743e12ab44">jkqtpstatHistogram2D</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly),</div>
<div class="line">                     datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(histcol),</div>
<div class="line">                     xmin, xmax, ymin, ymax,</div>
<div class="line">                     Nx, Ny, <span class="keyword">true</span>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dhist_html_gad8ab0d1e867375485e2c64743e12ab44"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dhist.html#gad8ab0d1e867375485e2c64743e12ab44">jkqtpstatHistogram2D</a></div><div class="ttdeci">void jkqtpstatHistogram2D(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, OutputIt histogramImgOut, double xmin, double xmax, double ymin, double ymax, size_t xbins=10, size_t ybins=10, bool normalized=true)</div><div class="ttdoc">calculate a 2-dimensional histogram from the given data range firstX / firstY ... lastY / lastY</div><div class="ttdef"><b>Definition</b> jkqtpstathistogram.h:287</div></div>
</div><!-- fragment --><p>Finally the histogram is drawn using a <span class="tt"><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></span>: </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>* gHist;</div>
<div class="line">plothist-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a63a54c5342d664c35ffb3d532ba26b99">addGraph</a>(gHist=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>(plothist));</div>
<div class="line">gHist-&gt;<a class="code hl_function" href="class_j_k_q_t_p_column_math_image.html#a64d8443502002fe626cbe55799f3c198">setImageColumn</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(histcol));</div>
<div class="line">gHist-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#a6f40e47f3d54070c6040406932b793da">setX</a>(xmin);</div>
<div class="line">gHist-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#acd02ce7527c76be7c9184073b76c31a6">setY</a>(ymin);</div>
<div class="line">gHist-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#ab7dafad9c0f645769850e6285b1d2ad6">setWidth</a>(xmax-xmin);</div>
<div class="line">gHist-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#a304f101a196b2b7e8a0287c39dd42355">setHeight</a>(ymax-ymin);</div>
<div class="line">gHist-&gt;<a class="code hl_function" href="class_j_k_q_t_p_math_image.html#a12c1ea21eed55cd34899742f15b17362">setTitle</a>(<span class="stringliteral">&quot;2D Histogram&quot;</span>);</div>
<div class="ttc" id="aclass_j_k_q_t_p_column_math_image_html"><div class="ttname"><a href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a></div><div class="ttdoc">class to plot an image from an 2-dimensional array of values stored in a column of the datastore</div><div class="ttdef"><b>Definition</b> jkqtpimage.h:771</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_column_math_image_html_a64d8443502002fe626cbe55799f3c198"><div class="ttname"><a href="class_j_k_q_t_p_column_math_image.html#a64d8443502002fe626cbe55799f3c198">JKQTPColumnMathImage::setImageColumn</a></div><div class="ttdeci">virtual void setImageColumn(int __value)</div><div class="ttdoc">column containing the displayed image</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_image_base_html_a304f101a196b2b7e8a0287c39dd42355"><div class="ttname"><a href="class_j_k_q_t_p_image_base.html#a304f101a196b2b7e8a0287c39dd42355">JKQTPImageBase::setHeight</a></div><div class="ttdeci">void setHeight(double __value)</div><div class="ttdoc">height of image</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_image_base_html_a6f40e47f3d54070c6040406932b793da"><div class="ttname"><a href="class_j_k_q_t_p_image_base.html#a6f40e47f3d54070c6040406932b793da">JKQTPImageBase::setX</a></div><div class="ttdeci">void setX(double __value)</div><div class="ttdoc">x coordinate of lower left corner</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_image_base_html_ab7dafad9c0f645769850e6285b1d2ad6"><div class="ttname"><a href="class_j_k_q_t_p_image_base.html#ab7dafad9c0f645769850e6285b1d2ad6">JKQTPImageBase::setWidth</a></div><div class="ttdeci">void setWidth(double __value)</div><div class="ttdoc">width of image</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_image_base_html_acd02ce7527c76be7c9184073b76c31a6"><div class="ttname"><a href="class_j_k_q_t_p_image_base.html#acd02ce7527c76be7c9184073b76c31a6">JKQTPImageBase::setY</a></div><div class="ttdeci">void setY(double __value)</div><div class="ttdoc">y coordinate of lower left corner</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_math_image_html_a12c1ea21eed55cd34899742f15b17362"><div class="ttname"><a href="class_j_k_q_t_p_math_image.html#a12c1ea21eed55cd34899742f15b17362">JKQTPMathImage::setTitle</a></div><div class="ttdeci">virtual void setTitle(const QString &amp;title) override</div><div class="ttdoc">sets the title of the plot (for display in key!).</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html_a63a54c5342d664c35ffb3d532ba26b99"><div class="ttname"><a href="class_j_k_q_t_plotter.html#a63a54c5342d664c35ffb3d532ba26b99">JKQTPlotter::addGraph</a></div><div class="ttdeci">size_t addGraph(JKQTPPlotElement *gr)</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:796</div></div>
</div><!-- fragment --><p>The resulting image plot looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_hist.png" alt="datastore_statistics_2d_hist" class="inline"/></p>
<p>There is also an "adaptor" which significanty reduce the amount of coude you have to type (i.e. it replaces all the code above):</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga0903341fc5a3e297a9f6c547df4b222f">jkqtpstatAddHistogram2DImage</a>(plothist-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a59f5e9add382cb1ad35ac7d17fe8d353">getPlotter</a>(), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly), Nx, Ny, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#gac73ef98710f4a642e534daf4d9e18709">jkqtpstatAddHistogram2DContour</a>(plothist-&gt;<a class="code hl_function" href="class_j_k_q_t_plotter.html#a59f5e9add382cb1ad35ac7d17fe8d353">getPlotter</a>(), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly), Nx, Ny, <span class="keyword">true</span>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga0903341fc5a3e297a9f6c547df4b222f"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga0903341fc5a3e297a9f6c547df4b222f">jkqtpstatAddHistogram2DImage</a></div><div class="ttdeci">JKQTPColumnMathImage * jkqtpstatAddHistogram2DImage(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, bool normalized=true, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional histogram and add a JKQTPColumnMathImage to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1059</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_gac73ef98710f4a642e534daf4d9e18709"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#gac73ef98710f4a642e534daf4d9e18709">jkqtpstatAddHistogram2DContour</a></div><div class="ttdeci">JKQTPColumnContourPlot * jkqtpstatAddHistogram2DContour(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, bool normalized=true, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional histogram and add a JKQTPColumnContourPlot to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1114</div></div>
</div><!-- fragment --><p>These differ in the type of plot that is added <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga0903341fc5a3e297a9f6c547df4b222f" title="calculate calculate a 2-dimensional histogram and add a JKQTPColumnMathImage to the given plotter,...">jkqtpstatAddHistogram2DImage()</a></span> adds an image graph (<span class="tt"><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></span>) and <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#gac73ef98710f4a642e534daf4d9e18709" title="calculate calculate a 2-dimensional histogram and add a JKQTPColumnContourPlot to the given plotter,...">jkqtpstatAddHistogram2DContour()</a></span> adds a contour plot (<span class="tt"><a class="el" href="class_j_k_q_t_p_column_contour_plot.html" title="class for a contour plots (same as JKQTPContourPlot) of images stored in a JKQTPDatastore column">JKQTPColumnContourPlot</a></span>). A contour plot may look like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_histcontour.png" alt="datastore_statistics_2d_histcontour" class="inline"/></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md60"></a>
Kernel Density Estimates (KDE)</h1>
<p>Especially when only few samples from a distribution are available, histograms are not good at representing the underlying data distribution. In such cases, <a href="https://en.wikipedia.org/wiki/Multivariate_kernel_density_estimation">Kernel Density Estimates (KDE)</a> can help, which are basically a smoothed variant of a histogram. The <a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a> supports calculating them via e.g. <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d" title="calculate an autoranged 2-dimensional Kernel Density Estimation (KDE) from the given data range first...">jkqtpstatKDE2D()</a></span>:</p>
<p>This functions calculates a histogram on a given grid with the first bin at <span class="tt">xmin,ymin</span> and the last bin at <span class="tt">xmax,ymax</span>, containing <span class="tt">Nx,Ny</span> bins in x-/y-direction. You can use the result to fill new image column (with <span class="tt">Nx</span> columns and <span class="tt">Ny</span> rows) in a <span class="tt"><a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a></span>, which can then be used to draw the histogram.</p>
<p>First we have to determine the x- and y-range of data and calculate the number of bins from these:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> xmin=0, xmax=0;</div>
<div class="line"><span class="keywordtype">double</span> ymin=0, ymax=0;</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx_small), xmin,xmax);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly_small), ymin,ymax);</div>
<div class="line">Nx=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga7d3fc545bf6193a1ad76bb2870327843">jkqtp_ceilTo&lt;size_t&gt;</a>((xmax-xmin)/0.1);</div>
<div class="line">Ny=<a class="code hl_function" href="group__jkqtptools__math__basic.html#ga7d3fc545bf6193a1ad76bb2870327843">jkqtp_ceilTo&lt;size_t&gt;</a>((ymax-ymin)/0.1);</div>
</div><!-- fragment --><p> We can also estimate the KDE-bandwidth for both directions now: </p><div class="fragment"><div class="line">bwx=<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx_small));</div>
<div class="line">bwy=<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly_small));</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_gad32be3dbb22fb9a1c9af695dba13ca43"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a></div><div class="ttdeci">double jkqtpstatEstimateKDEBandwidth2D(InputIt first, InputIt last)</div><div class="ttdoc">estimates a bandwidth for a 2-dimensional Kernel Density Estimator (KDE) of the given data first ....</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:629</div></div>
</div><!-- fragment --><p>Now we can add the image column </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> kdecol=datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a3ce797890c214db3794bca76ffefef8e">addImageColumn</a>(Nx, Ny, <span class="stringliteral">&quot;2d KDE&quot;</span>);</div>
</div><!-- fragment --><p> and calculate the histogram: </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d">jkqtpstatKDE2D</a>(datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly_small),</div>
<div class="line">                     datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(kdecol),</div>
<div class="line">                     xmin, xmax, ymin, ymax, Nx, Ny,</div>
<div class="line">                     &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">jkqtpstatKernel2DGaussian</a>, bwx, bwy);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde__kernels_html_gaba5d115fd8be2d295419818be380b277"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">jkqtpstatKernel2DGaussian</a></div><div class="ttdeci">double jkqtpstatKernel2DGaussian(double tx, double ty)</div><div class="ttdoc">a 2D Gaussian kernel function, e.g. for Kernel Density Estimation</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:148</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_gabea5faa220697a680179e0460ab6a46d"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d">jkqtpstatKDE2D</a></div><div class="ttdeci">void jkqtpstatKDE2D(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, OutputIt histogramImgOut, double xmin, double xmax, double ymin, double ymax, size_t xbins, size_t ybins, const std::function&lt; double(double, double)&gt; &amp;kernel=std::function&lt; double(double, double)&gt;(&amp;jkqtpstatKernel2DGaussian), double bandwidthX=1.0, double bandwidthY=1.0)</div><div class="ttdoc">calculate an autoranged 2-dimensional Kernel Density Estimation (KDE) from the given data range first...</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:566</div></div>
</div><!-- fragment --><p>Finally the histogram is drawn using a <span class="tt"><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></span>: </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>* gKDE;</div>
<div class="line">plotkde-&gt;addGraph(gKDE=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>(plotkde));</div>
<div class="line">gKDE-&gt;<a class="code hl_function" href="class_j_k_q_t_p_column_math_image.html#a64d8443502002fe626cbe55799f3c198">setImageColumn</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(kdecol));</div>
<div class="line">gKDE-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#a6f40e47f3d54070c6040406932b793da">setX</a>(xmin);</div>
<div class="line">gKDE-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#acd02ce7527c76be7c9184073b76c31a6">setY</a>(ymin);</div>
<div class="line">gKDE-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#ab7dafad9c0f645769850e6285b1d2ad6">setWidth</a>(xmax-xmin);</div>
<div class="line">gKDE-&gt;<a class="code hl_slot" href="class_j_k_q_t_p_image_base.html#a304f101a196b2b7e8a0287c39dd42355">setHeight</a>(ymax-ymin);</div>
<div class="line">gKDE-&gt;<a class="code hl_function" href="class_j_k_q_t_p_math_image.html#a12c1ea21eed55cd34899742f15b17362">setTitle</a>(<span class="stringliteral">&quot;2D KDE&quot;</span>);</div>
</div><!-- fragment --><p>The resulting plot image looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_kde.png" alt="datastore_statistics_2d_kde" class="inline"/></p>
<p>Note that calculating a KDE is a rather time-consuming task. The KDE in the image above took about 8s to calculate (from 150 datapairs and on a 193*267 pixel grid), whereas the corresponding histogram took only 1ms to calculate!</p>
<p>There is also an "adaptor" which significanty reduce the amount of coude you have to type (i.e. it replaces all the code above):</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga2169e4129730d013f94ad81ccf47209b">jkqtpstatAddKDE2DImage</a>(plotkde-&gt;getPlotter(), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly_small), Nx, Ny, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">jkqtpstatKernel2DGaussian</a>, bwx, bwy);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga7921c9edeb90d7eba8a36076528db331">jkqtpstatAddKDE2DContour</a>(plotkde-&gt;getPlotter(), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacolx_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#a6d3927a7c56a239d283e42fb6a48d6b7">begin</a>(randomdatacoly_small), datastore1-&gt;<a class="code hl_function" href="class_j_k_q_t_p_datastore.html#ab67341aad7c2de279970b5a7b5362042">end</a>(randomdatacoly_small), Nx, Ny, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#gaba5d115fd8be2d295419818be380b277">jkqtpstatKernel2DGaussian</a>, bwx, bwy);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga2169e4129730d013f94ad81ccf47209b"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga2169e4129730d013f94ad81ccf47209b">jkqtpstatAddKDE2DImage</a></div><div class="ttdeci">JKQTPColumnMathImage * jkqtpstatAddKDE2DImage(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, const std::function&lt; double(double, double)&gt; &amp;kernel=std::function&lt; double(double, double)&gt;(&amp;jkqtpstatKernel2DGaussian), double bandwidthX=1.0, double bandwidthY=1.0, const QString &amp;kdecolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnMathImage to t...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1640</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga7921c9edeb90d7eba8a36076528db331"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga7921c9edeb90d7eba8a36076528db331">jkqtpstatAddKDE2DContour</a></div><div class="ttdeci">JKQTPColumnContourPlot * jkqtpstatAddKDE2DContour(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, const std::function&lt; double(double, double)&gt; &amp;kernel=std::function&lt; double(double, double)&gt;(&amp;jkqtpstatKernel2DGaussian), double bandwidthX=1.0, double bandwidthY=1.0, const QString &amp;kdecolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnContourPlot to...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1697</div></div>
</div><!-- fragment --><p>These differ in the type of plot that is added <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga2169e4129730d013f94ad81ccf47209b" title="calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnMathImage to t...">jkqtpstatAddKDE2DImage()</a></span> adds an image graph (<span class="tt"><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></span>) and <span class="tt"><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga7921c9edeb90d7eba8a36076528db331" title="calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnContourPlot to...">jkqtpstatAddKDE2DContour()</a></span> adds a contour plot (<span class="tt"><a class="el" href="class_j_k_q_t_p_column_contour_plot.html" title="class for a contour plots (same as JKQTPContourPlot) of images stored in a JKQTPDatastore column">JKQTPColumnContourPlot</a></span>). the first is shown in the screenshot above, the latter looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_kdecontour.png" alt="datastore_statistics_2d_kdecontour" class="inline"/></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md61"></a>
Screenshot of the full Program</h1>
<p>The output of the full test program <a href="https://github.com/jkriege2/JKQtPlotter/tree/master/examples/datastore_statistics_2d/datastore_statistics_2d.cpp"><span class="tt">datastore_statistics_2d.cpp</span></a> looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d.png" alt="datastore_statistics_2d" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="example_tutorial_projects.html">Example &amp; Tutorial Projects</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for JKQTPlotter by <a href="https://www.doxygen.org/index.html">doxygen</a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
